var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,n=Object.getOwnPropertySymbols,s=Object.prototype.propertyIsEnumerable,i=(t,n,s)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s,o=(e,o)=>{for(var r in o||(o={}))t.call(o,r)&&i(e,r,o[r]);if(n)for(var r of n(o))s.call(o,r)&&i(e,r,o[r]);return e};import{r,L as a,M as l,S as c,_ as d,a as h,k as u,E as m,b as p,h as f,u as g,c as w,d as k,i as v,m as b,I as y,t as x,w as E,e as M,s as _,f as A,l as L,D as C,g as S,j as $,P as O,n as T,T as R,N as I,o as P,p as N,R as W,q as D,v as j,x as B,y as z,z as H,A as q,B as F,C as V,F as Y,G,H as U,J as K,K as Q,O as X,Q as J,U as Z,V as ee,W as te,X as ne,Y as se,Z as ie,$ as oe,a0 as re,a1 as ae,a2 as le,a3 as ce,a4 as de,a5 as he,a6 as ue,a7 as me,a8 as pe,a9 as fe,aa as ge}from"./vendor.4514d8a3.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const s=new URL(e,location),i=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,o)=>{const r=new URL(e,s);if(self[t].moduleMap[r])return n(self[t].moduleMap[r]);const a=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),l=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(a),onerror(){o(new Error(`Failed to import: ${e}`)),i(l)},onload(){n(self[t].moduleMap[r]),i(l)}});document.head.appendChild(l)})),self[t].moduleMap={}}}("/milkdown/assets/");var we="_body_1qygc_1",ke="_main_1qygc_10",ve="_title_1qygc_14",be="_desc_1qygc_23",ye="_logo_1qygc_31",xe="_buttons_1qygc_38";const Ee=()=>r.createElement("section",{className:we},r.createElement("section",{className:ke},r.createElement("section",{className:ye},r.createElement("img",{src:"/milkdown/milkdown.svg"})),r.createElement("h1",{className:ve},"Milkdown"),r.createElement("p",{className:be},"Plugin Based WYSIWYG Markdown Editor"),r.createElement("section",{className:xe},r.createElement(a,{to:"/getting-started"},"Get Started"),r.createElement(a,{to:"/online-demo"},"Online Demo"))));var Me,_e,Ae,Le,Ce,Se,$e,Oe,Te,Re,Ie,Pe,Ne,We,De,je,Be,ze,He,qe;(_e=Me||(Me={}))[_e.Idle=0]="Idle",_e[_e.LoadSchema=1]="LoadSchema",_e[_e.SchemaReady=2]="SchemaReady",_e[_e.PluginReady=3]="PluginReady",_e[_e.Complete=4]="Complete";class Fe{constructor(e={}){this.options=e}injectContext(e,t){this.context=e,this.updateContext=t}}class Ve extends Fe{constructor(){super(...arguments),this.loadAfter=Me.Idle}main(){this.updateContext({marks:this.context.marks.concat(this)})}}class Ye extends Fe{constructor(){super(...arguments),this.loadAfter=Me.Idle}main(){this.updateContext({nodes:this.context.nodes.concat(this)})}}function Ge(e,t,n={}){return e.reduce(((e,n)=>{const[s,i]=t(n);return Object.assign(Object.assign({},e),{[s]:i})}),n)}function Ue(e){return e.isText}class Ke extends Fe{constructor(){super(...arguments),this.id="schemaLoader",this.loadAfter=Me.LoadSchema}main(){const e=Ge(this.context.nodes,(e=>[e.id,e.schema])),t=Ge(this.context.marks,(e=>[e.id,e.schema])),n=new c({nodes:Object.assign(Object.assign({doc:{content:"block+"}},e),{text:{group:"inline"}}),marks:t});this.updateContext({schema:n})}}class Qe{constructor(e,t,n){this.stack=e,this.schema=t,this.tokenHandlers=n}parseTokens(e){e.forEach(((t,n)=>{const s=this.tokenHandlers[t.type];if(!s)throw new Error("Token type `"+t.type+"` not supported by Markdown parser");s(this,t,e,n)}))}addText(e){e&&this.stack.addText((t=>this.schema.text(e,t)))}transformTokensToDoc(e){this.parseTokens(e);let t=null;do{t=this.stack.closeNode()}while(this.stack.length);return t}}class Xe{constructor(e){Ae.add(this),Le.set(this,void 0),this.els=[{type:e,content:[]}],d(this,Le,l.none,"f")}get length(){return this.els.length}openMark(e){d(this,Le,e.addToSet(h(this,Le,"f")),"f")}closeMark(e){d(this,Le,e.removeFromSet(h(this,Le,"f")),"f")}addText(e){const t=h(this,Ae,"m",Ce).call(this);if(!t)throw new Error;const n=t.content,s=n[n.length-1],i=e(h(this,Le,"f")),o=s&&function(e,t){if(Ue(e)&&Ue(t)&&l.sameSet(e.marks,t.marks))return e.withText(e.text+t.text)}(s,i);o?n[n.length-1]=o:n.push(i)}openNode(e,t){this.els.push({type:e,attrs:t,content:[]})}addNode(e,t,n){const s=e.createAndFill(t,n,h(this,Le,"f"));return s?(h(this,Ae,"m",Se).call(this,s),s):null}closeNode(){h(this,Le,"f").length&&d(this,Le,l.none,"f");const e=this.els.pop();if(!e)throw new Error;return this.addNode(e.type,e.attrs,e.content)}}function Je(e,t,n,s){return e.getAttrs?e.getAttrs(t,n,s):e.attrs}function Ze(){}function et(e,t){const n={softbreak:e=>e.addText("\n")};return Object.entries(t).forEach((([t,s])=>{if(function(e){return Reflect.has(e,"block")}(s)){const i=e.nodes[s.block]||e.nodes[t];if(!i)throw new Error;return s.isAtom?void(n[s.block]=(e,t,n,o)=>{e.stack.openNode(i,Je(s,t,n,o)),e.addText(t.content),e.stack.closeNode()}):(n[s.block+"_open"]=(e,t,n,o)=>e.stack.openNode(i,Je(s,t,n,o)),void(n[s.block+"_close"]=e=>e.stack.closeNode()))}if(!function(e){return Reflect.has(e,"node")}(s)){if(function(e){return Reflect.has(e,"mark")}(s)){const i=e.marks[s.mark]||e.marks[t];if(!i)throw new Error;return s.isAtom?void(n[s.mark]=(e,t,n,o)=>{e.stack.openMark(i.create(Je(s,t,n,o))),e.addText(t.content),e.stack.closeMark(i)}):(n[s.mark+"_open"]=(e,t,n,o)=>e.stack.openMark(i.create(Je(s,t,n,o))),void(n[s.mark+"_close"]=e=>e.stack.closeMark(i)))}if(function(e){return Reflect.has(e,"ignore")}(s))return n[s.ignore+"_open"]=Ze,void(n[s.ignore+"_close"]=Ze);throw new RangeError("Unrecognized parsing spec "+JSON.stringify(s))}{const i=e.nodes[s.node]||e.nodes[t];if(!i)throw new Error;n[s.node]=(e,t,n,o)=>e.stack.addNode(i,Je(s,t,n,o))}})),n.inline=(e,t)=>{var n;return e.parseTokens(null!==(n=t.children)&&void 0!==n?n:[])},n.text=(e,t)=>e.addText(t.content),n}Le=new WeakMap,Ae=new WeakSet,Ce=function(){const{els:e}=this;return e[e.length-1]},Se=function(e){var t;null===(t=h(this,Ae,"m",Ce).call(this))||void 0===t||t.content.push(e)};class tt extends Fe{constructor(){super(...arguments),this.id="parserLoader",this.loadAfter=Me.SchemaReady}main(){const e=Ge([...this.context.nodes,...this.context.marks],(e=>[e.id,e.parser])),t=(n=this.context.schema,s=this.context.markdownIt,i=e,e=>new Qe(new Xe(n.topNodeType),n,et(n,i)).transformTokensToDoc(s.parse(e,{})));var n,s,i;this.updateContext({parser:t})}}class nt{static escape(e,t){let n=e.replace(/[`*\\~[\]]/g,"\\$&");return t&&(n=n.replace(/^[:#\-*+]/,"\\$&").replace(/^(\d+)\./,"$1\\.")),n}static quote(e){const t=-1===e.indexOf('"')?'""':-1===e.indexOf("'")?"''":"()";return t[0]+e+t[1]}static repeat(e,t){return Array(t).fill(e).reduce(((e,t)=>e+t),"")}static getEnclosingWhitespace(e){return{leading:(e.match(/^(\s+)/)||[])[0],trailing:(e.match(/(\s+)$/)||[])[0]}}static removeWhiteSpaceAfter(e){const t=/\s+$/.exec(e);return t?e.slice(0,t.index):e}}class st{constructor(e,t){$e.add(this),Oe.set(this,""),Te.set(this,""),Re.set(this,!1),Ie.set(this,void 0),Pe.set(this,void 0),this.utils=nt,d(this,Ie,e,"f"),d(this,Pe,t,"f")}get output(){return h(this,Oe,"f")}exec(e){return this.renderContent(e)}renderContent(e){return e.forEach(((t,n,s)=>h(this,$e,"m",Be).call(this,t,e,s))),this}ensureNewLine(){return h(this,$e,"a",Ne)||d(this,Oe,h(this,Oe,"f")+"\n","f"),this}closeBlock(e){return d(this,Re,e,"f"),this}write(e){return h(this,$e,"m",De).call(this),e?(h(this,Te,"f")&&h(this,$e,"a",Ne)&&d(this,Oe,h(this,Oe,"f")+h(this,Te,"f"),"f"),d(this,Oe,h(this,Oe,"f")+e,"f"),this):this}text(e,t=!1){const n=e.split("\n");return n.forEach(((e,s)=>{const i=t?this.utils.escape(e,Boolean(h(this,$e,"a",Ne)||h(this,Re,"f"))):e;this.write(i);s===n.length-1||d(this,Oe,h(this,Oe,"f")+"\n","f")})),this}wrapBlock(e,t,n,s=e){this.write(s);const i=h(this,Te,"f");return d(this,Te,h(this,Te,"f")+e,"f"),n(),d(this,Te,i,"f"),this.closeBlock(t),this}renderInline(e){let t=[];return e.forEach(((n,s,i)=>{if(!Ue(n))return void h(this,$e,"m",Be).call(this,n,e,i);const o=n.marks||[],r=t.filter((e=>!o.includes(e))).sort(h(this,$e,"m",ze).call(this)),a=o.filter((e=>!t.includes(e))).sort(h(this,$e,"m",ze).call(this,!0));a.forEach((e=>t.push(e))),t=t.filter((e=>!r.includes(e))).sort(h(this,$e,"m",ze).call(this));const l=h(this,$e,"m",We).call(this,a,e,i,!0),c=h(this,$e,"m",We).call(this,r,e,i+1);this.write(c+l+n.text)})),(()=>{const n=h(this,$e,"m",We).call(this,t,e,e.childCount+1);this.write(n)})(),this}renderList(e,t,n){h(this,Re,"f")&&h(this,Re,"f").type===e.type&&h(this,$e,"m",De).call(this,2),e.forEach(((s,i,o)=>{this.wrapBlock(t,e,(()=>h(this,$e,"m",Be).call(this,s,e,o)),n(o))}))}}Oe=new WeakMap,Te=new WeakMap,Re=new WeakMap,Ie=new WeakMap,Pe=new WeakMap,$e=new WeakSet,Ne=function(){return/(^|\n)$/.test(h(this,Oe,"f"))},We=function(e,t,n,s=!1){return e.map((e=>h(this,$e,"m",je).call(this,e,t,n,s))).join("")},De=function(e=1){if(!h(this,Re,"f"))return this;h(this,$e,"a",Ne)||d(this,Oe,h(this,Oe,"f")+"\n","f");const t=this.utils.removeWhiteSpaceAfter(h(this,Te,"f"));return d(this,Oe,h(this,Oe,"f")+this.utils.repeat(t+"\n",e),"f"),d(this,Re,!1,"f"),this},je=function(e,t,n,s=!1){const i=h(this,$e,"m",He).call(this,e),o=s?i.open:i.close;return"string"==typeof o?o:o(this,e,t,n)},Be=function(e,t,n){h(this,$e,"m",qe).call(this,e)(this,e,t,n)},ze=function(e=!1){return(t,n)=>{var s,i,o,r;const a=null!==(i=null===(s=h(this,$e,"m",He).call(this,t))||void 0===s?void 0:s.priority)&&void 0!==i?i:0,l=null!==(r=null===(o=h(this,$e,"m",He).call(this,n))||void 0===o?void 0:o.priority)&&void 0!==r?r:0;return e?a-l:l-a}},He=function(e){const t=h(this,Pe,"f")[e.type.name];if(!t)throw new Error(`Fail to get mark ${e.type.name} from mark map.`);return t},qe=function(e){const t=h(this,Ie,"f")[e.type.name];if(!t)throw new Error(`Fail to get node ${e.type.name} from node map.`);return t};class it extends Fe{constructor(){super(...arguments),this.id="serializerLoader",this.loadAfter=Me.SchemaReady}main(){const e=function(e,t){return n=>{const s=new st(e,t);return s.exec(n),s.output}}(Ge(this.context.nodes,(e=>[e.id,e.serializer]),{text(e,t){const{text:n}=t;n&&e.text(n)}}),Ge(this.context.marks,(e=>[e.id,e.serializer])));this.updateContext({serializer:e})}}class ot extends Fe{constructor(){super(...arguments),this.id="inputRulesLoader",this.loadAfter=Me.SchemaReady}main(){const{nodes:e,marks:t,schema:n}=this.context,s=[...e.reduce(((e,t)=>{const s=n.nodes[t.id];return s&&t.inputRules?[...e,...t.inputRules(s,n)]:e}),[]),...t.reduce(((e,t)=>{const s=n.marks[t.id];return s&&t.inputRules?[...e,...t.inputRules(s,n)]:e}),[])];this.updateContext({inputRules:s})}}class rt extends Fe{constructor(){super(...arguments),this.id="keymapLoader",this.loadAfter=Me.SchemaReady}main(){const{nodes:e,marks:t,schema:n}=this.context,s=[...e.map((e=>{var t;const s=n.nodes[e.id];if(!s)throw new Error;return null===(t=e.keymap)||void 0===t?void 0:t.call(e,s)})),...t.map((e=>{var t;const s=n.marks[e.id];if(!s)throw new Error;return null===(t=e.keymap)||void 0===t?void 0:t.call(e,s)}))].filter((e=>Boolean(e))).map((e=>u(e)));this.updateContext({keymap:s})}}class at extends Fe{constructor(){super(...arguments),this.id="nodeViewsLoader",this.loadAfter=Me.SchemaReady}main(){const{nodes:e,marks:t,schema:n,editor:s}=this.context,i=e.filter((e=>Boolean(e.view))).reduce(((e,t)=>{const{view:i}=t,o=n.nodes[t.id];return o&&i?Object.assign(Object.assign({},e),{[t.id]:(...e)=>i(s,o,...e)}):e}),{}),o=t.filter((e=>Boolean(e.view))).reduce(((e,t)=>{const{view:i}=t,o=n.marks[t.id];return o&&i?Object.assign(Object.assign({},e),{[t.id]:(...e)=>i(s,o,...e)}):e}),{}),r=Object.assign(Object.assign({},i),o);this.updateContext({nodeViews:r})}}class lt extends Fe{constructor(){super(...arguments),this.id="viewLoader",this.loadAfter=Me.PluginReady}main(){const{nodeViews:e,serializer:t}=this.context,{listener:n,editable:s}=this.options,i=this.createState(),o=this.createViewContainer(),r=new m(o,{state:i,nodeViews:e,editable:s,dispatchTransaction:e=>{var s,i;const o=r.state.apply(e);r.updateState(o),null===(s=n.markdown)||void 0===s||s.forEach((e=>{e((()=>t(r.state.doc)))})),null===(i=n.doc)||void 0===i||i.forEach((e=>{e(r.state.doc)}))}});this.prepareViewDom(r.dom),this.updateContext({editorView:r})}createState(){const{parser:e,schema:t,inputRules:n,keymap:s,prosemirrorPlugins:i}=this.context,{defaultValue:o}=this.options,r=e(o);return p.create({schema:t,doc:r,plugins:[f(),u({"Mod-z":g,"Shift-Mod-z":w}),...s,...i,u(k),v({rules:n})]})}createViewContainer(){const{root:e}=this.options,t=document.createElement("div");return t.className="milkdown",e.appendChild(t),t}prepareViewDom(e){e.classList.add("editor"),e.setAttribute("role","textbox")}}const ct=e=>class extends Fe{constructor(){super(...arguments),this.id=e,this.loadAfter=Me.SchemaReady}main(){this.updateContext({prosemirrorPlugins:this.context.prosemirrorPlugins.concat(...this.options.plugins(this.context))})}},dt=(e,t)=>new(ct(e))({plugins:t}),ht=e=>class extends Fe{constructor(){super(...arguments),this.id=e,this.loadAfter=Me.SchemaReady}main(){const e=this.options.plugins(this.context).reduce(((e,t)=>Array.isArray(t)?e.use(...t):e.use(t)),this.context.markdownIt);this.updateContext({markdownIt:e})}},ut=(e,t)=>new(ht(e))({plugins:t}),mt=e=>class extends Fe{constructor(){super(...arguments),this.id=e,this.loadAfter=Me.SchemaReady}main(){const e=this.options.rules(this.context),t=this.context.markdownIt.enable(e);this.updateContext({markdownIt:t})}};var pt,ft,gt,wt,kt,vt,bt;class yt{constructor(e){pt.add(this),ft.set(this,[]),gt.set(this,{loadState:Me.Idle,markdownIt:new b("commonmark"),nodes:[],marks:[],editor:this,prosemirrorPlugins:[]}),wt.set(this,(e=>{Object.assign(h(this,gt,"f"),e)}));const t=Object.assign({root:document.body,defaultValue:"",listener:{}},e);this.use([new Ke,new tt,new it,new rt,new ot,new at,new lt(t)])}use(e){return Array.isArray(e)?(e.forEach((e=>{h(this,pt,"m",bt).call(this,e)})),this):(h(this,pt,"m",bt).call(this,e),this)}create(){h(this,pt,"m",kt).call(this),[Me.Idle,Me.LoadSchema,Me.SchemaReady,Me.PluginReady,Me.Complete].forEach((e=>{h(this,gt,"f").loadState=e,h(this,pt,"m",vt).call(this,e)}))}}function xt(e,t){return new y(e,((e,n,s,i)=>{const{tr:o}=e,r=n.length;let a=s,l=i;if(n[r-1]){const c=n[0],d=n[r-1],h=n[r-2],u=s+c.indexOf(h),m=u+h.length-1,p=u+h.lastIndexOf(d),f=p+d.length;if(function(e,t,n){let s=[];return n.doc.nodesBetween(e,t,((e,t)=>{s=[...s,...e.marks.map((n=>({start:t,end:t+e.nodeSize,mark:n})))]})),s}(s,i,e).filter((e=>e.mark.type.excludes(t))).filter((e=>e.end>u)).length)return null;f<m&&o.delete(f,m),p>u&&o.delete(u,p),a=u,l=a+d.length}return o.addMark(a,l,t.create()),o.removeStoredMark(t),o}))}ft=new WeakMap,gt=new WeakMap,wt=new WeakMap,pt=new WeakSet,kt=function(){h(this,ft,"f").forEach((e=>e.injectContext(h(this,gt,"f"),h(this,wt,"f"))))},vt=function(e){h(this,ft,"f").filter((t=>t.loadAfter===e)).forEach((e=>{e.main()}))},bt=function(e){const t=h(this,ft,"f").findIndex((t=>t.id===e.id));t>=0&&(console.warn(`Atom: ${e.id} is conflicted with previous atom, the previous one will be override.`),h(this,ft,"f").splice(t,1)),h(this,ft,"f").push(e)};const Et=[new class extends Ve{constructor(){super(...arguments),this.id="link",this.schema={attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>({href:e.getAttribute("href"),title:e.getAttribute("title")})}],toDOM:e=>["a",Object.assign(Object.assign({},e.attrs),{class:"link"})]},this.parser={mark:"link",getAttrs:e=>({href:e.attrGet("href"),title:e.attrGet("title")||null})},this.serializer={open:()=>"[",close:(e,t)=>`](${e.utils.escape(t.attrs.href)}${t.attrs.title?` ${e.utils.quote(t.attrs.title)}`:""})`,priority:1},this.inputRules=(e,t)=>[new y(/\[(?<text>.+?)]\((?<href>.*?)(?=“|\))"?(?<title>[^"]+)?"?\)/,((n,s,i,o)=>{const[r,a="",l,c]=s,{tr:d}=n;return r&&d.replaceWith(i,o,t.text(a)).addMark(i,a.length+i,e.create({title:c,href:l})),d}))]}},new class extends Ve{constructor(){super(...arguments),this.id="strong",this.schema={parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-style",getAttrs:e=>"bold"===e}],toDOM:()=>["strong",{class:"strong"}]},this.parser={mark:this.id},this.serializer={open:"**",close:"**"},this.inputRules=e=>[xt(/(?:__)([^_]+)(?:__)$/,e),xt(/(?:\*\*)([^*]+)(?:\*\*)$/,e)],this.keymap=e=>({"Mod-b":x(e)})}},new class extends Ve{constructor(){super(...arguments),this.id="code_inline",this.schema={excludes:"_",parseDOM:[{tag:"code"}],toDOM:()=>["code",{class:"code-inline"}]},this.parser={mark:"code_inline",isAtom:!0},this.serializer={open:"`",close:"`"},this.inputRules=e=>[xt(/(?:^|[^`])(`([^`]+)`)$/,e)]}},new class extends Ve{constructor(){super(...arguments),this.id="em",this.schema={parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>"italic"===e}],toDOM:()=>["em",{class:"em"}]},this.parser={mark:"em"},this.serializer={open:"*",close:"*"},this.inputRules=e=>[xt(/(?:^|[^_])(_([^_]+)_)$/,e),xt(/(?:^|[^*])(\*([^*]+)\*)$/,e)],this.keymap=e=>({"Mod-i":x(e)})}}];const Mt=Array(5).fill(0).map(((e,t)=>t+1));const _t=["","javascript","typescript","bash","sql","json","html","css","c","cpp","java","ruby","python","go","rust"];const At=[...[new class extends Ye{constructor(){super(...arguments),this.id="paragraph",this.schema={content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:()=>["p",{class:"paragraph"},0]},this.parser={block:this.id},this.serializer=(e,t)=>{e.renderInline(t).closeBlock(t)}}},new class extends Ye{constructor(){super(...arguments),this.id="hardbreak",this.schema={inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br",{class:"bard-break"}]},this.parser={block:this.id,isAtom:!0},this.serializer=e=>{e.write("  \n")},this.keymap=e=>({"Shift-Enter":(t,n)=>(null==n||n(t.tr.replaceSelectionWith(e.create()).scrollIntoView()),!0)})}},new class extends Ye{constructor(){super(...arguments),this.id="blockquote",this.schema={content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",{class:"blockquote"},0]},this.parser={block:this.id},this.serializer=(e,t)=>{e.wrapBlock("> ",t,(()=>e.renderContent(t)))},this.inputRules=e=>[E(/^\s*>\s$/,e)]}},new class extends Ye{constructor(){super(...arguments),this.id="fence",this.schema={content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>({language:e.dataset.language})}],toDOM:e=>{const t=this.createSelectElement(e.attrs.language);return["div",{"data-language":e.attrs.language,class:"code-fence"},["div",{contentEditable:"false"},t],["pre",["code",{spellCheck:"false"},0]]]}},this.parser={block:this.id,getAttrs:e=>({language:e.info}),isAtom:!0},this.serializer=(e,t)=>{e.write("```"+t.attrs.language+"\n"),e.text(t.textContent),e.ensureNewLine(),e.write("```"),e.closeBlock(t)},this.inputRules=e=>[M(/^```$/,e)],this.keymap=()=>({Tab:(e,t)=>{const{tr:n,selection:s}=e;return!!t&&(t(n.insertText("  ",s.from,s.to)),!0)}})}onChangeLanguage(e,t,n){const{editorView:s}=this.context,i=s.posAtCoords({top:e,left:t});if(!i)return;const o=s.state.tr.setNodeMarkup(i.inside,void 0,{language:n});s.dispatch(o)}createSelectElement(e){const t=document.createElement("select");return t.className="code-fence_select",t.addEventListener("mousedown",(e=>{const{editorView:t}=this.context;t.editable||e.preventDefault()})),t.addEventListener("change",(e=>{if(this.context.loadState!==Me.Complete)throw new Error("Should not trigger event before milkdown ready.");const t=e.target;if(!t)return;const{top:n,left:s}=t.getBoundingClientRect();this.onChangeLanguage(n,s,t.value)})),_t.forEach((n=>{const s=document.createElement("option");s.className="code-fence_select-option",s.value=n,s.innerText=n||"--",s.selected=e===n,t.appendChild(s)})),t}},new class extends Ye{constructor(){super(...arguments),this.id="ordered_list",this.schema={content:"list_item+",group:"block",attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:e=>({order:e.hasAttribute("start")?Number(e.getAttribute("start")):1})}],toDOM:e=>["ol",Object.assign(Object.assign({},1===e.attrs.order?{}:e.attrs.order),{class:"ordered-list"}),0]},this.parser={block:this.id},this.serializer=(e,t)=>{const{order:n=1}=t.attrs,s=(""+(n+t.childCount-1)).length,i=e.utils.repeat(" ",s+2);e.renderList(t,i,(t=>{const i=`${n+t}`;return e.utils.repeat(" ",s-i.length)+i+". "}))},this.inputRules=e=>[E(/^(\d+)\.\s$/,e,(e=>({order:Number(e[1])})),((e,t)=>t.childCount+t.attrs.order===Number(e[1])))]}},new class extends Ye{constructor(){super(...arguments),this.id="bullet_list",this.schema={content:"list_item+",group:"block",parseDOM:[{tag:"ul"}],toDOM:()=>["ul",{class:"bullet-list"},0]},this.parser={block:this.id},this.serializer=(e,t)=>{e.renderList(t,"  ",(()=>"* "))},this.inputRules=e=>[E(/^\s*([-+*])\s$/,e)]}},new class extends Ye{constructor(){super(...arguments),this.id="list_item",this.schema={content:"paragraph block*",defining:!0,parseDOM:[{tag:"li"}],toDOM:()=>["li",{class:"list-item"},0]},this.parser={block:this.id},this.serializer=(e,t)=>{e.renderContent(t)},this.keymap=e=>({Enter:_(e),"Mod-]":A(e),"Mod-[":L(e)})}},new class extends Ye{constructor(){super(...arguments),this.id="heading",this.schema={content:"text*",group:"block",attrs:{level:{default:1}},parseDOM:Mt.map((e=>({tag:`h${e}`,attrs:{level:e}}))),toDOM:e=>[`h${e.attrs.level}`,{class:`heading h${e.attrs.level}`},0]},this.parser={block:this.id,getAttrs:e=>({level:Number(e.tag.slice(1))})},this.serializer=(e,t)=>{e.write(`${e.utils.repeat("#",t.attrs.level)} `),e.renderInline(t),e.closeBlock(t)},this.inputRules=e=>Mt.map((t=>M(new RegExp(`^(#{1,${t}})\\s$`),e,(()=>({level:t})))))}},new class extends Ye{constructor(){super(...arguments),this.id="hr",this.schema={group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["hr",{class:"hr"}]},this.parser={block:this.id,isAtom:!0},this.serializer=(e,t)=>{e.write("---"),e.closeBlock(t)},this.inputRules=e=>[new y(/^(?:---|___\s|\*\*\*\s)$/,((t,n,s,i)=>{const{tr:o}=t;return n[0]&&o.replaceWith(s,i,e.create({})),o}))]}},new class extends Ye{constructor(){super(...arguments),this.id="image",this.schema={inline:!0,attrs:{src:{default:""},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,marks:"",parseDOM:[{tag:"img[src]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{src:e.getAttribute("src")||"",alt:e.getAttribute("alt"),title:e.getAttribute("title")}}}],toDOM:e=>{var t;return(null===(t=e.attrs.src)||void 0===t?void 0:t.length)>0?["img",Object.assign(Object.assign({},e.attrs),{class:"image"})]:["div",Object.assign(Object.assign({},e.attrs),{class:"image empty"}),["span",{contentEditable:"false",class:"icon"}],["span",{contentEditable:"false",class:"placeholder"}]]}},this.parser={node:"image",getAttrs:e=>{var t,n;return{src:e.attrGet("src")||"",alt:(null===(n=null===(t=e.children)||void 0===t?void 0:t[0])||void 0===n?void 0:n.content)||null,title:e.attrGet("title")}}},this.serializer=(e,t)=>{const n=e.utils.escape(t.attrs.alt||""),s=t.attrs.title?" "+e.utils.quote(t.attrs.title):"",i=e.utils.escape(t.attrs.src)+s;e.write(`![${n}](${i}) `)},this.inputRules=e=>[new y(/!\[(?<alt>.*?)]\((?<filename>.*?)(?=“|\))"?(?<title>[^"]+)?"?\)/,((t,n,s,i)=>{const[o,r,a="",l]=n,{tr:c}=t;return o&&c.replaceWith(s,i,e.create({src:a,alt:r,title:l})),c}))]}},new class extends Ye{constructor(){super(...arguments),this.id="tab_indent",this.schema={group:"inline",inline:!0,selectable:!1,parseDOM:[{tag:"span[class='tab-indent']"}],toDOM:()=>["span",{class:"tab-indent"},"  "]},this.parser={block:this.id},this.serializer=e=>{e.write("  ")},this.keymap=e=>({Tab:(t,n)=>{const{selection:s}=t.tr,i=Boolean(t.tr);if(!s)return i;const{from:o,to:r}=s;if(o!==r||!e)return i;const a=t.tr.replaceSelectionWith(e.create()).scrollIntoView();return null==n||n(a),Boolean(a)}})}}],...Et],Lt=e=>t=>{const{$from:n}=t;for(let s=n.depth;s>0;s--){const t=n.node(s);if(e(t))return{pos:s>0?n.before(s):0,start:n.start(s),depth:s,node:t}}},Ct=e=>(t,n)=>{let s;const{from:i,to:o}=t;return n.nodesBetween(i,o,((t,n)=>{if(s)return!1;e(t)&&(s={node:t,pos:n})})),s},St=e=>Object.assign(Object.create(e),e).setTime(Date.now()),$t=(Ot=e=>e.isBlock,(e,t)=>((e,t=!0)=>{const n=[];return e.descendants(((e,s)=>{if(n.push({node:e,pos:s}),!t)return!1})),n})(e,t).filter((e=>Ot(e.node))));var Ot;const Tt={};const Rt="MILKDOWN_PLUGIN_PRISM";function It(e){let t=!1;return new O({key:new T(Rt),state:{init:(e,{doc:t})=>C.create(t,[]),apply:(n,s,i,o)=>{const r=o.selection.$head.parent.type.name===e,a=i.selection.$head.parent.type.name===e,l=n.docChanged&&(r||a);return!t||l?(t=!0,function(e,t){const n=[],s=$t(e).filter((e=>e.node.type.name===t));return s.forEach((e=>{var t;let s=e.pos+1;const i=e.node.attrs.language;if(i){if(!(null===(t=Tt[e.pos])||void 0===t?void 0:t.node.eq(e.node))){const t=S.highlight(e.node.textContent,i),n=(e,t=[])=>e.flatMap((e=>"element"===e.type?n(e.children,[...t,...e.properties.className||[]]):[{text:e.value,className:t}])),o=n(t).map((({text:e,className:t})=>{const n=s,i=n+e.length;return s=i,$.inline(n,i,{class:t.join(" ")})}));Tt[e.pos]={node:e.node,dec:o}}Tt[e.pos].dec.forEach((e=>{n.push(e)}))}})),Object.keys(Tt).filter((e=>!s.find((t=>t.pos===Number(e))))).forEach((e=>{delete Tt[Number(e)]})),C.create(e,n)}(n.doc,e)):s.map(n.mapping,n.doc)}},view:e=>(window.requestAnimationFrame((()=>{e.dispatch(e.state.tr.setMeta(Rt,{loaded:!0}))})),{}),props:{decorations(e){return this.getState(e)}}})}const Pt=dt("prism",(()=>[It("fence")])),Nt=(e,t)=>e.tagName===t.toUpperCase(),Wt=e=>{const t=document.createElement("span");return t.textContent=e,t.className="icon material-icons",t},Dt=(e,t)=>{const{from:n,to:s}=e.selection;return e.doc.rangeHasMark(n,s,t)},jt=(e,t)=>{var n;return null===(n=Ct((e=>Boolean(t.isInSet(e.marks))))(e.selection,e.doc))||void 0===n?void 0:n.node},Bt=(e,t)=>!(e=>e.selection instanceof R)(e)||(e=>Boolean(Lt((e=>"fence"===e.type.name))(e.selection)))(e)||Dt(e,t),zt=(e,t,n)=>(s,i)=>{if(!i)return!1;const{start:o,end:r}=((e,t)=>{let n={start:-1,end:-1};const s=Ct((e=>Boolean(t.isInSet(e.marks))))(e.selection,e.doc);return s&&(n={start:s.pos,end:s.pos+Math.max(s.node.textContent.length,1)}),n})(s,e),{tr:a}=s,l=t.create(Object.assign(Object.assign({},e.attrs),{href:n}));return a.removeMark(o,r).addMark(o,r,l).setSelection(new R(a.selection.$anchor)),i(a.scrollIntoView()),!0},Ht=(e,t)=>(n,s)=>{const{target:i}=n,{nodes:o}=e,{image:r}=o;if(!(i instanceof HTMLElement))return()=>!0;if(Nt(i,"input"))return i.focus(),()=>!1;const a=qt(s.state.selection,r);if(!a)return()=>!1;const l=i.parentNode;if(!l)return()=>!1;const c=Array.from(l.children).find((e=>"INPUT"===e.tagName));return c instanceof HTMLInputElement?(e,n)=>{if(!n)return!1;const{tr:s}=e;return s.setNodeMarkup(a.pos,void 0,Object.assign(Object.assign({},a.node.attrs),{[t]:c.value})),n(s.scrollIntoView()),!0}:()=>!1},qt=(e,t)=>{if(!(e instanceof I))return;const{node:n,$from:s}=e;return((e,t)=>Array.isArray(e)&&e.indexOf(t.type)>-1||t.type===e)(t,n)?{node:n,pos:s.pos,depth:s.depth}:void 0},Ft=(e,t,n,s)=>({$:Wt(e),command:()=>x(t,s),active:e=>Dt(e.state,t),disable:e=>Bt(e.state,n)});var Vt,Yt,Gt,Ut;(Yt=Vt||(Vt={}))[Yt.ToggleBold=0]="ToggleBold",Yt[Yt.ToggleItalic=1]="ToggleItalic",Yt[Yt.ToggleCode=2]="ToggleCode",Yt[Yt.ToggleLink=3]="ToggleLink",(Ut=Gt||(Gt={}))[Ut.ModifyLink=0]="ModifyLink",Ut[Ut.ModifyImage=1]="ModifyImage";var Kt,Qt,Xt,Jt,Zt,en,tn,nn;class sn{constructor(e,t){this.view=t,Kt.set(this,void 0),Qt.set(this,void 0),Xt.set(this,(e=>{const{view:t}=this;if(!t)return;const n=Object.values(h(this,Qt,"f")).find((({$:t})=>e.target instanceof Element&&t.contains(e.target)));n&&(e.stopPropagation(),e.preventDefault(),n.command(e,t)(t.state,t.dispatch))})),d(this,Qt,e,"f"),d(this,Kt,this.createTooltip(),"f"),h(this,Kt,"f").addEventListener("mousedown",h(this,Xt,"f"))}destroy(){h(this,Kt,"f").removeEventListener("mousedown",h(this,Xt,"f")),h(this,Kt,"f").remove()}hide(){h(this,Kt,"f").classList.add("hide")}update(e){this.filterButton(e)?this.hide():this.calcPos(e)}get noActive(){return Object.values(h(this,Qt,"f")).every((({$:e})=>e.classList.contains("hide")))}filterButton(e){return Object.values(h(this,Qt,"f")).forEach((t=>{var n;if(null===(n=t.disable)||void 0===n?void 0:n.call(t,e))return void t.$.classList.add("hide");t.$.classList.remove("hide");t.active(e)?t.$.classList.add("active"):t.$.classList.remove("active")})),this.noActive}calcPos(e){var t;h(this,Kt,"f").classList.remove("hide");const n=e.state,{from:s,to:i}=n.selection,o=e.coordsAtPos(s),r=e.coordsAtPos(i),a=Math.max((o.left+r.left)/2,o.left+3),l=null===(t=h(this,Kt,"f").offsetParent)||void 0===t?void 0:t.getBoundingClientRect();l&&(h(this,Kt,"f").style.left=a-l.left+"px",h(this,Kt,"f").style.bottom=l.bottom-o.top+"px")}createTooltip(){var e;const t=document.createElement("div");return t.className="tooltip",Object.values(h(this,Qt,"f")).forEach((({$:e})=>t.appendChild(e))),null===(e=this.view.dom.parentNode)||void 0===e||e.appendChild(t),t}}Kt=new WeakMap,Qt=new WeakMap,Xt=new WeakMap;class on{constructor(e,t){this.view=t,Jt.set(this,void 0),Zt.set(this,void 0),en.set(this,void 0),this.listener=e=>{const{view:t}=this,n=h(this,en,"f");t&&n&&(e.stopPropagation(),n(e,t)(t.state,t.dispatch))},d(this,Zt,e,"f"),d(this,Jt,this.createInput(),"f"),h(this,Jt,"f").addEventListener("mousedown",this.listener)}destroy(){h(this,Jt,"f").removeEventListener("mousedown",this.listener),h(this,Jt,"f").remove()}hide(){h(this,Jt,"f").classList.add("hide"),d(this,en,void 0,"f")}update(e){this.filterInput(e)&&this.calcPos(e)}calcPos(e){var t;const n=e.state,{from:s,to:i}=n.selection,o=e.coordsAtPos(s),r=e.coordsAtPos(i),a=Math.max((o.left+r.left)/2,o.left+3),l=h(this,Jt,"f").getBoundingClientRect(),c=null===(t=h(this,Jt,"f").offsetParent)||void 0===t?void 0:t.getBoundingClientRect();if(!c)return;const d=a-c.left-l.width/2,u=d+l.width;h(this,Jt,"f").style.left=(u>c.width?d-(u-c.width):d<0?a-c.left:d)+"px",h(this,Jt,"f").style.bottom=c.bottom-o.bottom-l.height-10+"px"}createInput(){var e;const t=document.createElement("div");t.className="tooltip-input";const n=document.createElement("input");t.appendChild(n);const s=document.createElement("button");return s.textContent="APPLY",t.appendChild(s),null===(e=this.view.dom.parentNode)||void 0===e||e.appendChild(t),t}filterInput(e){var t;const n=Object.values(h(this,Zt,"f")).find((t=>t.display(e)));return n?(h(this,Jt,"f").classList.remove("hide"),d(this,en,n.command,"f"),null===(t=h(this,Jt,"f").firstElementChild)||void 0===t||t.setAttribute("placeholder",n.placeholder),n.update(e,h(this,Jt,"f")),!0):(h(this,Jt,"f").classList.add("hide"),!1)}}Jt=new WeakMap,Zt=new WeakMap,en=new WeakMap;class rn{constructor(e,t,n){tn.set(this,void 0),nn.set(this,void 0),d(this,tn,new sn(e,n),"f"),d(this,nn,new on(t,n),"f"),this.update(n)}update(e,t){if(!e.editable)return void this.hide();const n=e.state;if(n.selection.empty)return void this.hide();(null==t?void 0:t.doc.eq(n.doc))&&t.selection.eq(n.selection)||(h(this,tn,"f").update(e),h(this,nn,"f").update(e))}destroy(){h(this,tn,"f").destroy(),h(this,nn,"f").destroy()}hide(){h(this,tn,"f").hide(),h(this,nn,"f").hide()}}tn=new WeakMap,nn=new WeakMap;const an=e=>new O({key:new T("MILKDOWN_PLUGIN_TOOLTIP"),view:t=>new rn((e=>{const{marks:t}=e.schema;return{[Vt.ToggleBold]:Ft("format_bold",t.strong,t.code_inline),[Vt.ToggleItalic]:Ft("format_italic",t.em,t.code_inline),[Vt.ToggleCode]:Ft("code",t.code_inline,t.link),[Vt.ToggleLink]:Ft("link",t.link,t.code_inline,{href:""})}})(e),(e=>{const{marks:t,nodes:n}=e.schema;return{[Gt.ModifyLink]:{display:e=>Dt(e.state,t.link),command:(s=e.schema,(e,t)=>{var n;const{target:i}=e,{marks:o}=s,{link:r}=o;if(!(i instanceof HTMLElement))return()=>!0;if(Nt(i,"input"))return i.focus(),()=>!1;const a=jt(t.state,r);if(!a)return()=>!1;const l=a.marks.find((({type:e})=>e===r));if(!l)return()=>!1;const c=null===(n=i.parentNode)||void 0===n?void 0:n.firstChild;return c instanceof HTMLInputElement?zt(l,o.link,c.value):()=>!1}),placeholder:"Input Web Link",update:(e,n)=>{const{firstChild:s}=n;if(!(s instanceof HTMLInputElement))return;const i=jt(e.state,t.link);if(!i)return;const o=i.marks.find((e=>e.type===t.link));o&&(s.value=o.attrs.href)}},[Gt.ModifyImage]:{display:e=>Boolean(qt(e.state.selection,n.image)),command:Ht(e.schema,"src"),placeholder:"Input Image Link",update:(e,t)=>{const{firstChild:s}=t;if(!(s instanceof HTMLInputElement))return;const i=qt(e.state.selection,n.image);i&&(s.value=i.node.attrs.src)}}};var s})(e),t)}),ln=dt("tooltip",(e=>[an(e)]));const cn=[new class extends Ye{constructor(){super(...arguments),this.id="math_inline",this.schema={group:"inline math",content:"text*",inline:!0,atom:!0,parseDOM:[{tag:"math-inline"}],toDOM:()=>["math-inline",{class:"math-node"},0]},this.parser={block:this.id,isAtom:!0},this.serializer=(e,t)=>{e.write("$"),e.renderContent(t),e.write("$")},this.inputRules=e=>[P(W,e)]}},new class extends Ye{constructor(){super(...arguments),this.id="math_display",this.schema={group:"block math",content:"text*",atom:!0,code:!0,parseDOM:[{tag:"math-display"}],toDOM:()=>["math-display",{class:"math-node"},0]},this.parser={block:"math_block",isAtom:!0},this.serializer=(e,t)=>{e.write("$$").ensureNewLine().renderContent(t).ensureNewLine().write("$$").closeBlock(t)},this.inputRules=e=>[N(D,e)]}}],dn=u({Backspace:j(z,H,q,F)}),hn=[...cn,dt("mathProsemirrorPlugin",(()=>[B,dn])),ut("mathMarkdownItPlugin",(()=>[V]))],un=e=>Lt((e=>"table"===e.type.spec.tableRole))(e),mn=(e,t=3,n=3)=>{const{cell:s,header_cell:i,row:o,table:r}=Y(e),a=Array(n).fill(0).map((()=>s.createAndFill(null))),l=Array(n).fill(0).map((()=>i.createAndFill(null))),c=Array(t).fill(0).map(((e,t)=>o.create(null,0===t?l:a)));return r.create(null,c)},pn=e=>t=>n=>{const s=un(n.selection),i="row"===e;if(s){const e=G.get(s.node);if(t>=0&&t<(i?e.height:e.width)){const o=e.positionAt(i?t:e.height-1,i?e.width-1:t,s.node),r=n.doc.resolve(s.start+o),a=i?U.rowSelection:U.colSelection,l=e.positionAt(i?t:0,i?0:t,s.node),c=n.doc.resolve(s.start+l);return St(n.setSelection(a(r,c)))}}return n},fn=e=>{const t=(e=>{const t=un(e);if(!t)return;const n=G.get(t.node);return n.cellsInRect({left:0,right:n.width,top:0,bottom:n.height}).map((e=>{const n=t.node.nodeAt(e),s=e+t.start;return{pos:s,start:s+1,node:n}}))})(e.selection);if(t){const n=e.doc.resolve(t[0].pos),s=e.doc.resolve(t[t.length-1].pos);return St(e.setSelection(new U(s,n)))}return e},gn=K({tableGroup:"block",cellContent:"table_inline",cellAttributes:{alignment:{default:"left",getFromDOM:e=>e.style.textAlign||"left",setDOMAttr:(e,t)=>{t.style=`text-align: ${e||"left"}`}}}});const wn=[new class extends Ye{constructor(){super(...arguments),this.id="table",this.schema=gn.table,this.parser={block:this.id},this.serializer=(e,t)=>{let n="";e.ensureNewLine(),t.forEach(((t,s,i)=>{n&&(e.write(`${n}|\n`),n=""),t.forEach(((t,s,o)=>{if(e.write(0===o?"| ":" | "),e.renderContent(t),0===i)switch(t.attrs.alignment){case"center":return void(n+="|:---:");case"left":return void(n+="|:---");case"right":return void(n+="|---:");default:return void(n+="|----")}})),e.write(" |\n")})),e.closeBlock(t)},this.inputRules=(e,t)=>[new y(/^\|\|\s$/,((n,s,i,o)=>{const r=n.doc.resolve(i);if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),e))return null;const a=mn(t),l=n.tr.replaceRangeWith(i,o,a).scrollIntoView();return l.setSelection(R.create(l.doc,i+3))}))]}},new class extends Ye{constructor(){super(...arguments),this.id="table_row",this.schema=gn.table_row,this.parser={block:"tr"},this.serializer=()=>{}}},new class extends Ye{constructor(){super(...arguments),this.id="table_cell",this.schema=gn.table_cell,this.parser={block:"td",getAttrs:e=>({alignment:e.info})},this.serializer=()=>{}}},new class extends Ye{constructor(){super(...arguments),this.id="table_header",this.schema=gn.table_header,this.parser={block:"th",getAttrs:e=>({alignment:e.info})},this.serializer=()=>{}}},new class extends Ye{constructor(){super(...arguments),this.id="table_inline",this.schema={content:"inline*",group:"block",parseDOM:[{tag:"span"}],toDOM:()=>["span",{class:"table-inline"},0]},this.parser={block:this.id},this.serializer=(e,t)=>{e.renderInline(t)}}}];var kn,vn,bn,yn,xn,En,Mn,_n;function An(e){const t=document.createElement("span");return t.textContent=e,t.className="icon material-icons material-icons-outlined",t}(En=xn||(xn={})).Left="Left",En.Top="Top",En.Point="Point",(_n=Mn||(Mn={}))[_n.AddColLeft=0]="AddColLeft",_n[_n.AddColRight=1]="AddColRight",_n[_n.AddRowTop=2]="AddRowTop",_n[_n.AddRowBottom=3]="AddRowBottom",_n[_n.AlignLeft=4]="AlignLeft",_n[_n.AlignCenter=5]="AlignCenter",_n[_n.AlignRight=6]="AlignRight",_n[_n.Delete=7]="Delete";const Ln=e=>e.state.selection;var Cn,Sn;(Sn=Cn||(Cn={})).Col="Col",Sn.Row="Row",Sn.All="All";const $n=e=>{const t=Ln(e),n=t.isRowSelection(),s=t.isColSelection();return n&&s?Cn.All:n?Cn.Row:Cn.Col};class On{constructor(){kn.set(this,[]),vn.set(this,void 0),bn.set(this,void 0),yn.set(this,{[Mn.AddColLeft]:{$:An("chevron_left"),command:()=>Q,disable:e=>$n(e)!==Cn.Col},[Mn.AddColRight]:{$:An("chevron_right"),command:()=>X,disable:e=>$n(e)!==Cn.Col},[Mn.AddRowTop]:{$:An("expand_less"),command:()=>J,disable:e=>$n(e)!==Cn.Row||"table_header"===Ln(e).$head.parent.type.name},[Mn.AddRowBottom]:{$:An("expand_more"),command:()=>Z,disable:e=>$n(e)!==Cn.Row},[Mn.AlignLeft]:{$:An("format_align_left"),command:()=>ee("alignment","left"),disable:e=>!Ln(e).isColSelection()},[Mn.AlignCenter]:{$:An("format_align_center"),command:()=>ee("alignment","center"),disable:e=>!Ln(e).isColSelection()},[Mn.AlignRight]:{$:An("format_align_right"),command:()=>ee("alignment","right"),disable:e=>!Ln(e).isColSelection()},[Mn.Delete]:{$:An("delete"),command:(e,t)=>{const n=Ln(t),s=n.isColSelection(),i=n.isRowSelection();return s&&i?te:s?ne:se}}}),this.key=new T("TABLE_OP"),this.decorations=e=>{const t=(n=0,e=>{const t=un(e);if(!t)return;const s=G.get(t.node);return n<0||n>=s.width?void 0:s.cellsInRect({left:n,right:n+1,top:0,bottom:s.height}).map((e=>{const n=t.node.nodeAt(e);if(!n)throw new Error;const s=e+t.start;return{pos:s,start:s+1,node:n}}))})(e.selection);var n;if(!t)return null;const s=(i=0,e=>{const t=un(e);if(!t)return;const n=G.get(t.node);return i<0||i>=n.height?void 0:n.cellsInRect({left:0,right:n.width,top:i,bottom:i+1}).map((e=>{const n=t.node.nodeAt(e);if(!n)throw new Error;const s=e+t.start;return{pos:s,start:s+1,node:n}}))})(e.selection);var i;if(!s)return null;const[o]=t;return this.createWidget(o,xn.Point),t.forEach(((e,t)=>{this.createWidget(e,xn.Left,t)})),s.forEach(((e,t)=>{this.createWidget(e,xn.Top,t)})),C.create(e.doc,h(this,kn,"f"))},this.update=(e,t)=>{const n=e.state;if((null==t?void 0:t.doc.eq(n.doc))&&t.selection.eq(n.selection))return;n.selection instanceof U&&e.editable?(this.calculateItem(e),Object.values(h(this,yn,"f")).every((({$:e})=>e.classList.contains("hide")))?this.hide():(h(this,vn,"f").classList.remove("hide"),this.calculatePosition(e))):this.hide()},this.props={decorations:this.decorations},this.view=e=>{var t;return d(this,bn,e,"f"),Object.values(h(this,yn,"f")).forEach((({$:e})=>h(this,vn,"f").appendChild(e))),null===(t=e.dom.parentNode)||void 0===t||t.appendChild(h(this,vn,"f")),this.update(e),h(this,vn,"f").addEventListener("mousedown",this.listener),{update:this.update,destroy:()=>{h(this,vn,"f").removeEventListener("mousedown",this.listener),h(this,vn,"f").remove()}}},this.listener=e=>{const t=h(this,bn,"f");t&&(e.stopPropagation(),e.preventDefault(),Object.values(h(this,yn,"f")).forEach((({$:n,command:s})=>{n.contains(e.target)&&s(e,t)(t.state,t.dispatch)})))},d(this,vn,document.createElement("div"),"f"),h(this,vn,"f").classList.add("table-tooltip")}createWidget(e,t,n=0){const s=$.widget(e.pos+1,(()=>{const e=document.createElement("div");return e.classList.add(this.calculateClassName(t)),e.addEventListener("mousedown",(e=>{if(h(this,bn,"f"))switch(e.preventDefault(),t){case xn.Point:return void h(this,bn,"f").dispatch(fn(h(this,bn,"f").state.tr));case xn.Left:return void h(this,bn,"f").dispatch(pn("row")(n)(h(this,bn,"f").state.tr));case xn.Top:return void h(this,bn,"f").dispatch(pn("col")(n)(h(this,bn,"f").state.tr))}})),e}));h(this,kn,"f").push(s)}calculateClassName(e){switch(e){case xn.Left:return"milkdown-cell-left";case xn.Top:return"milkdown-cell-top";case xn.Point:return"milkdown-cell-point";default:throw new Error}}calculatePosition(e){var t;const n=e.state.selection,s=n.isColSelection(),i=n.isRowSelection();if(!s&&!i)return;const{from:o,to:r}=n,a=e.coordsAtPos(o),l=e.coordsAtPos(r),c=Math.max((a.left+l.left)/2,a.left+3),d=null===(t=h(this,vn,"f").offsetParent)||void 0===t?void 0:t.getBoundingClientRect();if(!d)return;const u=c-d.left-(i?8:-e.domAtPos(o).node.getBoundingClientRect().width/2+16),m=d.bottom-a.bottom;h(this,vn,"f").style.left=u+"px",h(this,vn,"f").style.bottom=m+"px"}calculateItem(e){Object.values(h(this,yn,"f")).forEach((t=>{var n;(null===(n=t.disable)||void 0===n?void 0:n.call(t,e))?t.$.classList.add("hide"):t.$.classList.remove("hide")}))}hide(){h(this,vn,"f").classList.add("hide")}}kn=new WeakMap,vn=new WeakMap,bn=new WeakMap,yn=new WeakMap;const Tn=/(?:^|[^\\])\\n/;function Rn(e){e.core.ruler.after("inline","milkdown-table",(e=>{const t=e.tokens;let n=!1;for(let s=t.length-1;s>0;s--){if(n&&t[s].level--,"inline"===t[s].type&&t[s].content.match(Tn)){const e=t[s].children||[];t[s].children=[],e.forEach((e=>{var n;const i=e.content.split(Tn);i.length>1&&"code_inline"!==e.type?i.forEach(((e,n)=>{var o,r;const a=new ie("text","",1);if(a.content=e.trim(),null===(o=t[s].children)||void 0===o||o.push(a),n<i.length-1){const e=new ie("br","br",1);null===(r=t[s].children)||void 0===r||r.push(e)}})):null===(n=t[s].children)||void 0===n||n.push(e)}))}if(["thead_open","thead_close","tbody_open","tbody_close"].includes(t[s].type)&&(n=!n,t.splice(s,1)),["th_open","td_open"].includes(t[s].type)){t.splice(s+1,0,new ie("table_inline_open","span",1));const e=t[s].attrs;if(e){const n=e[0][1];t[s].info=n.split(":")[1]}}["th_close","td_close"].includes(t[s].type)&&t.splice(s,0,new ie("table_inline_close","span",-1))}return!1}))}const In=dt("milkdown-table",(e=>{return[ae({}),le(),new O(new On),u({"Mod-]":ce(1),"Mod-[":ce(-1),"Mod-Enter":(t=e.schema.nodes.paragraph,(e,n)=>{if(!oe(e))return!1;const{$head:s}=e.selection,i=s.after(),o=e.tr.replaceWith(i,i,t.createAndFill());return o.setSelection(re.near(o.doc.resolve(i),1)),null==n||n(o.scrollIntoView()),!0})})];var t}));var Pn;const Nn=[...wn,(Pn=()=>["table"],new(mt("milkdown-table-rule"))({rules:Pn})),ut("milkdown-table-markdown",(()=>[Rn])),In],Wn=e=>{const t=document.createElement("span");return t.textContent=e,t.classList.add("slash-placeholder"),t},Dn=(e,t)=>{const n=document.createElement("div");n.classList.add("slash-dropdown-item");const s=document.createElement("span");s.textContent=t,s.className="icon material-icons material-icons-outlined";const i=document.createElement("span");return i.textContent=e,i.className="text",n.appendChild(s),n.appendChild(i),n};var jn,Bn;(Bn=jn||(jn={}))[Bn.Divider=0]="Divider",Bn[Bn.H1=1]="H1",Bn[Bn.H2=2]="H2",Bn[Bn.H3=3]="H3",Bn[Bn.BulletList=4]="BulletList",Bn[Bn.OrderedList=5]="OrderedList",Bn[Bn.Quote=6]="Quote",Bn[Bn.CodeFence=7]="CodeFence",Bn[Bn.Table=8]="Table",Bn[Bn.DivideLine=9]="DivideLine",Bn[Bn.Image=10]="Image";const zn=e=>t=>(n,s)=>{if(!s)return!1;const{selection:i}=n,{$head:o}=i,r=o.pos-1-o.parent.content.size,a=n.tr.replaceWith(r,o.pos,e(t)),l=o.pos-1-o.parent.content.size+1,c=R.create(a.doc,l);return s(a.setSelection(c)),!0},Hn=[{type:jn.H1,$:Dn("Large Heading","looks_one"),command:zn((e=>e.schema.nodes.heading.create({level:1}))),keyword:["h1","large heading"]},{type:jn.H2,$:Dn("Medium Heading","looks_two"),command:zn((e=>e.schema.nodes.heading.create({level:2}))),keyword:["h2","medium heading"]},{type:jn.H3,$:Dn("Small Heading","looks_3"),command:zn((e=>e.schema.nodes.heading.create({level:3}))),keyword:["h3","small heading"]},{type:jn.BulletList,$:Dn("Bullet List","format_list_bulleted"),command:zn((e=>e.schema.nodes.bullet_list.createAndFill(null))),keyword:["bullet list","ul"]},{type:jn.OrderedList,$:Dn("Ordered List","format_list_numbered"),command:zn((e=>e.schema.nodes.ordered_list.createAndFill(null))),keyword:["ordered list","ol"]},{type:jn.Image,$:Dn("Image","image"),command:zn((e=>e.schema.nodes.image.createAndFill({src:""}))),keyword:["image"]},{type:jn.Quote,$:Dn("Quote","format_quote"),command:zn((e=>e.schema.nodes.blockquote.createAndFill(null))),keyword:["quote","blockquote"]},{type:jn.Table,$:Dn("Table","table_chart"),command:zn((e=>mn(e.schema))),keyword:["table"]},{type:jn.CodeFence,$:Dn("Code Fence","code"),command:zn((e=>e.schema.nodes.fence.createAndFill(null))),keyword:["code"]},{type:jn.DivideLine,$:Dn("Divide Line","horizontal_rule"),command:zn((e=>e.schema.nodes.hr.create())),keyword:["divider","hr"]}];var qn,Fn,Vn,Yn,Gn,Un,Kn,Qn,Xn,Jn,Zn;const es=dt("slash",(e=>[ts(e)])),ts=e=>new O(new is(e));var ns,ss;(ss=ns||(ns={}))[ss.Empty=0]="Empty",ss[ss.Slash=1]="Slash";class is{constructor(e){this.ctx=e,this.key=new T("milkdown-prosemirror-slash-plugin"),this.status=new os,this.props=new rs(this.status),this.view=e=>new as(this.status,e,this.ctx)}}class os{constructor(){qn.set(this,ns.Empty),Fn.set(this,""),this.activeActions=Hn}clearStatus(){d(this,qn,ns.Empty,"f"),d(this,Fn,"","f")}setSlash(e=""){d(this,qn,ns.Slash,"f"),d(this,Fn,e,"f")}get cursorStatus(){return h(this,qn,"f")}get filter(){return h(this,Fn,"f")}}qn=new WeakMap,Fn=new WeakMap;class rs{constructor(e){this.status=e,this.handleKeyDown=(e,t)=>{const{cursorStatus:n,activeActions:s}=this.status;return n===ns.Slash&&0!==s.length&&(t instanceof KeyboardEvent&&!!["ArrowUp","ArrowDown","Enter"].includes(t.key))},this.decorations=e=>{const t=Lt((({type:e})=>"paragraph"===e.name))(e.selection);if(!t)return this.status.clearStatus(),null;const n=1===e.selection.$from.depth,s=0===t.node.content.size,i="/"===t.node.textContent,o=t.node.textContent.startsWith("/"),r=(t,n)=>C.create(e.doc,[$.widget(t,Wn(n))]);return n?s?(this.status.clearStatus(),r(t.pos+1,"Type / to use the slash commands...")):i?(this.status.setSlash(),r(t.pos+2,"Type to filter...")):o?(this.status.setSlash(t.node.textContent.slice(1)),null):(this.status.clearStatus(),null):(this.status.clearStatus(),null)}}}class as{constructor(e,t,n){Vn.set(this,void 0),Yn.set(this,void 0),Gn.set(this,void 0),Un.set(this,void 0),Kn.set(this,void 0),Qn.set(this,(e=>{const{target:t}=e;if(!(t instanceof HTMLElement))return;const n=h(this,Kn,"f");if(!n)return;const s=Object.values(Hn).find((({$:e})=>e.contains(t)));s&&(e.stopPropagation(),e.preventDefault(),s.command(h(this,Gn,"f"))(n.state,n.dispatch))})),Xn.set(this,(e=>{const{key:t}=e;if(h(this,Un,"f").cursorStatus!==ns.Slash)return;if(!["ArrowDown","ArrowUp","Enter"].includes(t))return;let n=h(this,Un,"f").activeActions.findIndex((e=>e.$.classList.contains("active")));if(n<0&&(n=0),"ArrowDown"===t){const e=n===h(this,Un,"f").activeActions.length-1?0:n+1;return h(this,Un,"f").activeActions[n].$.classList.remove("active"),h(this,Un,"f").activeActions[e].$.classList.add("active"),void de(h(this,Un,"f").activeActions[e].$,{scrollMode:"if-needed",block:"nearest",inline:"nearest"})}if("ArrowUp"===t){const e=0===n?h(this,Un,"f").activeActions.length-1:n-1;return h(this,Un,"f").activeActions[n].$.classList.remove("active"),h(this,Un,"f").activeActions[e].$.classList.add("active"),void de(h(this,Un,"f").activeActions[e].$,{scrollMode:"if-needed",block:"nearest",inline:"nearest"})}h(this,Un,"f").activeActions[n].command(h(this,Gn,"f"))(h(this,Kn,"f").state,h(this,Kn,"f").dispatch),h(this,Un,"f").activeActions[n].$.classList.remove("active")})),Jn.set(this,(e=>{const t=h(this,Un,"f").activeActions.findIndex((e=>e.$.classList.contains("active")));t>=0&&h(this,Un,"f").activeActions[t].$.classList.remove("active");const{target:n}=e;n instanceof HTMLElement&&n.classList.add("active")})),Zn.set(this,(e=>{const{target:t}=e;t instanceof HTMLElement&&t.classList.remove("active")})),d(this,Un,e,"f"),d(this,Vn,(()=>{const e=document.createElement("div");return e.classList.add("slash-dropdown"),e})(),"f"),d(this,Gn,n,"f"),d(this,Kn,t,"f");const{parentNode:s}=t.dom;if(!s)throw new Error;d(this,Yn,s,"f"),s.appendChild(h(this,Vn,"f")),Hn.forEach((({$:e})=>{e.addEventListener("mouseenter",h(this,Jn,"f")),e.addEventListener("mouseleave",h(this,Zn,"f")),h(this,Vn,"f").appendChild(e)})),h(this,Yn,"f").addEventListener("mousedown",h(this,Qn,"f")),h(this,Yn,"f").addEventListener("keydown",h(this,Xn,"f"))}update(e){this.renderDropdown()&&this.calculatePosition(e)}destroy(){h(this,Yn,"f").removeEventListener("mousedown",h(this,Qn,"f")),h(this,Yn,"f").removeEventListener("keydown",h(this,Xn,"f")),h(this,Vn,"f").remove()}renderDropdown(){const{cursorStatus:e,filter:t}=h(this,Un,"f");if(e!==ns.Slash)return h(this,Vn,"f").classList.add("hide"),!1;const n=Hn.filter((e=>{e.$.classList.remove("active");return!!e.keyword.some((e=>e.includes(t.toLocaleLowerCase())))||(e.$.classList.add("hide"),!1)})).map((e=>(e.$.classList.remove("hide"),e)));return h(this,Un,"f").activeActions=n,0===n.length?(h(this,Vn,"f").classList.add("hide"),!1):(n[0].$.classList.add("active"),h(this,Vn,"f").classList.remove("hide"),de(n[0].$,{scrollMode:"if-needed",block:"nearest",inline:"nearest"}),!0)}calculatePosition(e){var t;const n=e.state,{from:s}=n.selection,i=e.coordsAtPos(s),o=null===(t=h(this,Vn,"f").offsetParent)||void 0===t?void 0:t.getBoundingClientRect();if(!o)return;const r=h(this,Vn,"f").getBoundingClientRect();if(h(this,Vn,"f").style.left=i.left-o.left+"px",Math.abs(i.bottom-o.bottom)>r.height)return h(this,Vn,"f").style.bottom="",void(h(this,Vn,"f").style.top=i.top-o.top+20+"px");h(this,Vn,"f").style.top="",h(this,Vn,"f").style.bottom=i.bottom-o.bottom+190+"px"}}Vn=new WeakMap,Yn=new WeakMap,Gn=new WeakMap,Un=new WeakMap,Kn=new WeakMap,Qn=new WeakMap,Xn=new WeakMap,Jn=new WeakMap,Zn=new WeakMap;const ls=[es];var cs="_editor_rw7v4_1";const ds=({content:e,readOnly:t})=>{const n=r.useRef(null);return r.useEffect((()=>{const s=n.current;if(!s)throw new Error;return((e,t,n=!1)=>{let s=new yt({root:e,defaultValue:t,editable:()=>!n}).use(At).use(Pt).use(ln).use(Nn).use(hn);n||(s=s.use(ls)),s.create()})(s,e,t),()=>{s.remove()}}),[e,t]),r.createElement("div",{className:cs,ref:n})},hs="https://unpkg.com/prism-themes/themes/prism-material-light.css",us="https://unpkg.com/prism-themes/themes/prism-nord.css",ms=(e,t)=>{r.useEffect((()=>{var e;const n=Boolean(null==(e=window.matchMedia)?void 0:e.call(window,"(prefers-color-scheme: dark)").matches);t(n)}),[t]),r.useEffect((()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light");(()=>{const e=document.querySelector("#prism-theme");if(e)return e;const t=document.createElement("link");return t.id="prism-theme",t.setAttribute("rel","stylesheet"),document.head.appendChild(t),t})().setAttribute("href",e?us:hs)}),[e])};var ps,fs;(fs=ps||(ps={}))[fs.Home=0]="Home",fs[fs.Demo=1]="Demo",fs[fs.Page=2]="Page";const gs=e=>"/"===e.pathname?0:"/online-demo"===e.pathname?1:2;function ws(){const e=he();return[gs(e),e]}var ks={header:"_header_py9rh_1",scrolled:"_scrolled_py9rh_18",part:"_part_py9rh_22",icon:"_icon_py9rh_26",logo:"_logo_py9rh_40"};const vs=`${ks.icon} material-icons-outlined`,bs=({onToggle:e,scrolled:t})=>{const[n,s]=r.useState(!1),[i,o]=r.useState(!0),[a]=ws();return r.useEffect((()=>{a===ps.Page?o(!0):o(!1)}),[a]),ms(n,s),r.createElement("header",{className:[ks.header,t?ks.scrolled:""].join(" ")},r.createElement("div",{className:ks.part},i&&r.createElement("span",{className:vs,onClick:()=>null==e?void 0:e()},"menu"),r.createElement("a",{href:"/milkdown/",className:ks.logo},r.createElement("img",{src:"/milkdown/milkdown-mini.svg"}),r.createElement("span",{style:{opacity:t?0:1,transition:"all 0.2s ease-in"}},"Milkdown"))),r.createElement("div",{className:ks.part},r.createElement("span",{onClick:()=>s(!n),className:vs},n?"light_mode":"dark_mode"),r.createElement("a",{href:"https://github.com/Saul-Mirone/milkdown",target:"_blank",className:ks.github},r.createElement("span",{className:vs},"open_in_new"))))};var ys="_sidebar_4j968_1",xs="_fold_4j968_10",Es="_hr_4j968_24",Ms="_section_4j968_30",_s="_sectionTitle_4j968_34",As="_link_4j968_41",Ls="_active_4j968_53";const Cs=({title:e,link:t})=>r.createElement(ue,{className:As,activeClassName:Ls,to:t},e),Ss=({title:e,items:t})=>r.createElement("section",{className:Ms},r.createElement("section",{className:_s},e),t.map(((e,t)=>r.createElement(Cs,o({key:t.toString()},e))))),$s=({sections:e,setDisplay:t,display:n})=>{const[s,i]=ws();r.useEffect((()=>{s===ps.Page?(console.log(document.documentElement.clientWidth),document.documentElement.clientWidth<1080?t(!1):t(!0)):t(!1)}),[s,t,i]);const a=r.useMemo((()=>`${ys} ${n?"":xs}`),[n]);return r.createElement("nav",{className:a},e.map(((t,n)=>r.createElement("section",{key:n.toString()},r.createElement(Ss,o({key:n.toString()},t)),n<e.length-1&&r.createElement("hr",{className:Es})))))};const Os=[{title:"Guide",items:[{title:"Why Milkdown",link:"/why-milkdown",content:"# Why Milkdown\n\nThere are kinds of different markdown editors, such as [Typora](https://typora.io/), [tui](https://github.com/nhn/tui.editor) and [Bear](https://bear.app/).\nThey work pretty well for writing notes in markdown on different platforms. So why bother making Milkdown?\n\nMilkdown aims to provide a **open source solution** for developers to make their editors more powerful, attractive, and can be used everywhere.\n\n---\n\n## Open Source & Easy to Integration\n\nDifferent from industry apps such as [Notion](https://notion.so) and [Typora](https://typora.io/),\nMilkdown is open source and fully free. You can integrate it everywhere legally.\n\n> If you like milkdown, please consider to fund me to help the maintenance.\n\n## Plugin Driven\n\nMilkdown treats every features as plugins.\nWith this pattern, developers can choose what they need in an editor instead of bundle all features even they won't need.\nDevelopers can extends the plugin to satisfy their habit such as define a vim keymap plugin.\n\n## Reliable\n\nMilkdown is powered by [Prosemirror](https://prosemirror.net/) and [Markdown-It](https://markdown-it.github.io/), which has large community and stands the test of industry.\nWhat's more, plugins in prosemirror and markdown-it community can be easily reused to build a Milkdown plugin.\n\n## Themable & Hackable\n\nThemes and plugins for Milkdown can be shared and installed using npm packages.\n"},{title:"Getting Started",link:"/getting-started",content:"# Getting Started\n\n## Overview\n\nMilkdown is a lightweight but powerful WYSIWYG markdown editor. It's made up by two parts:\n\n-   A tiny core which provide markdown parser, serializer and kinds of plugin loader.\n-   Lots of plugins provide syntax, commands and components.\n\nWith this pattern you can enable or disable any custom syntax you like, such as table, latex and slash commands.\nYou can even create your own plugin to support your awesome idea.\n\n---\n\n## Features\n\n-   📝 **WYSIWYG Markdown** - Write markdown in an elegant way\n-   🎨 **Themable** - Theme can be shared and used with npm packages\n-   🎮 **Hackable** - Support your awesome idea by plugin\n-   🦾 **Reliable** - Built on top of [prosemirror](https://prosemirror.net/) and [markdown-it](https://markdown-it.github.io/)\n-   ⚡️ **Slash & Tooltip** - Write fast for everyone, driven by plugin\n-   🧮 **Math** - LaTeX math equations support, driven by plugin\n-   📊 **Table** - Table support with fluent ui, driven by plugin\n\n## Tech Stack\n\nMilkdown is built on top of these tools:\n\n-   [Prosemirror](https://prosemirror.net/) and it's community - A toolkit for building rich-text editors on the web\n-   [Markdown-it](https://markdown-it.github.io/) and it's community - Markdown parser done right\n-   [Postcss](https://postcss.org/) - Powerful css tool to build theme\n-   [TypeScript](https://www.typescriptlang.org/) - Developed by typescript\n-   [Prism](https://prismjs.com/) - Code snippets support\n-   [Katex](https://katex.org/) - LaTex math rendering\n\n---\n\n## First editor\n\nWe have some pieces for you to create a very minimal editor:\n\n> **We use [material icon](https://fonts.google.com/icons) and [Roboto Font](https://fonts.google.com/specimen/Roboto) in our theme**.\n> Make sure to include them for having the best experience.\n\n```typescript\nimport { Editor } from '@milkdown/core';\nimport { commonmark } from '@milkdown/preset-commonmark';\n\n// import theme\nimport '@milkdown/theme-nord/lib/theme.css';\n\nconst root = document.body;\nnew Editor({ root }).use(commonmark).create();\n```\n"},{title:"Using Plugins",link:"/using-plugins",content:"# Using Plugins\n\n## Tasting a Plugin\n\nIn fact, all features in milkdown are supported by plugin.\nThe `commonmark` we use is a plugin. Now we can try more plugins:\n\n```typescript\nimport { Editor } from '@milkdown/core';\nimport { commonmark } from '@milkdown/preset-commonmark';\n\nimport '@milkdown/theme-nord/lib/theme.css';\n\nimport { tooltip } from '@milkdown/plugin-tooltip';\n// don't forget to import style!\nimport '@milkdown/plugin-tooltip/lib/style.css';\n\nconst root = document.body;\nnew Editor({ root }).use(commonmark).use(tooltip).create();\n```\n\n---\n\n## Finding Plugins\n\n### Official Plugins\n\nMilkdown provides the following official plugins:\n\n-   [@milkdown/plugin-table](https://www.npmjs.com/package/@milkdown/plugin-table)\n\n    Add table syntax support.\n\n-   [@milkdown/Plugin-prism](https://www.npmjs.com/package/@milkdown/plugin-prism)\n\n    Add [prism](https://prismjs.com/) support for code block highlight.\n\n-   [@milkdown/Plugin-tooltip](https://www.npmjs.com/package/@milkdown/plugin-tooltip)\n\n    Add selected tooltip for text.\n\n-   [@milkdown/Plugin-slash](https://www.npmjs.com/package/@milkdown/plugin-slash)\n\n    Add slash commands support.\n\n### Community plugins\n\nCheck out [awesome-milkdown]() to find community plugins - you can also submit a PR to list your plugins there.\n"},{title:"Interacting with Editor",link:"/interacting-with-editor",content:"# Interacting with Editor\n\n## Setting Default Value\n\nYou can set a markdown string as the default value of the editor.\n\n```typescript\nnew Editor({\n    ...\n    defaultValue: '# Hello milkdown',\n});\n```\n\nAnd then the editor will be rendered with default value.\n\n---\n\n## Adding Listener\n\nYou can add listener to the editor, get values when needed.\n\n### Markdown Listener\n\nYou can add markdown listener to get the markdown string output when needed.\n\nYou can add as many listeners as you want, all the listener will be triggered in one change.\n\n```typescript\nlet output = '';\n\nnew Editor({\n    ...\n    listener: {\n        markdown: [\n            (getMarkdown) => {\n                if (needGetOutput) {\n                    output = getMarkdown();\n                }\n            },\n            (getMarkdown) => {\n                if (needLog) {\n                    console.log(getMarkdown())\n                }\n            }\n        ]\n    }\n})\n```\n\n### Doc Listener\n\nYou can also listen to the [raw prosemirror document node](https://prosemirror.net/docs/ref/#model.Node), and do things you want.\n\n```typescript\nlet jsonOutput;\n\nnew Editor({\n    ...\n    listener: {\n        docs: [\n            (node) => {\n                jsonOutput = node.toJSON();\n            },\n        ]\n    }\n})\n```\n\n---\n\n## Readonly mode\n\nYou can set the editor to readonly mode by set the `editable` property.\n\n```typescript\nlet readonly = false;\nnew Editor({\n    ...\n    editable: () => !readonly,\n})\n\n// set to readonly after 5 secs.\nsetTimeout(() => {\n    readonly = true;\n}, 5000)\n```\n"}]},{title:"Architecture",items:[{title:"Core",link:"/core",content:"# Core\n\nMilkdown core is composed mainly by three parts:\n\n-   Markdown Parser\n-   Markdown Serializer\n-   Prosemirror\n\n---\n\n## Markdown Parser\n\n> The parser can **transform a markdown string into a prosemirror node tree**.\n\nIt is mainly used by transforming the default value, and can be used in features like paste markdown strings.\n\nThe parser will parse the markdown strings into tokens by [markdown-it](https://github.com/markdown-it/markdown-it),\nand transform the tokens into the prosemirror node.\n\n## Markdown Serializer\n\n> The serializer can **transform a prosemirror node into a markdown string**.\n\nIt is mainly used by listeners, and can be used in features like export to file.\n\n## Prosemirror\n\n> Prosemirror is **used for render editor**.\n\nWhen users interact with the editor, they actually interact with the [prosemirror view instance](https://prosemirror.net/docs/guide/#view).\n\n---\n\nSo basically,\na milkdown editor works following these steps:\n\n1. Default value is parsed by parser, generates a node.\n2. Node generated by step 1 will be used to create a prosemirror instance.\n3. When changes are triggered, the listeners will be called and developers can use serializer to get markdown string.\n"},{title:"Atom",link:"/atom",content:"# Atom\n\nIn the world of milkdown, everything are `Atom`s.\nThe only thing the core part of milkdown do is execute theses atoms one by one.\n\nAtom has the shape of the following structure:\n\n```typescript\nclass Atom {\n    id: string;\n    loadAfter: LoadState;\n    main() {\n        const currentCtx = this.context;\n        const myCtx = myHandler(currentCtx);\n        this.updateContext(myCtx);\n    }\n}\n```\n\nEvery atom should implement 2 props and 1 method:\n\n## id\n\nThe identifier of current atom. It must have no conflict with other atoms.\n\n## loadAfter\n\nThe timing that current atom need to be loaded.\n\n## main\n\nA method that will be executed when current atom is loaded, in this method, you can use 2 props on `this`:\n\n-   this.context: readonly property, get the current context of the editor.\n-   this.updateContext: used to update the context of the editor.\n"}]},{title:"APIs",items:[{title:"Core API",link:"/core-api",content:"# Core API\n\n Coming soon..."},{title:"Plugin API",link:"/plugin-api",content:"# Plugin API\n\n Coming soon..."}]}];var Ts="_main_10j7q_1",Rs="_container_10j7q_7";var Is="_footer_1h38t_1";const Ps=()=>r.createElement("footer",{className:Is},"MIT Licensed | Copyright © 2021-present Mirone Saul"),Ns=Os.flatMap((e=>e.items)),Ws=()=>{const[e,t]=r.useState(!0),[n,s]=r.useState(!1),i=r.useRef(null);return r.useEffect((()=>{if(!i.current)return;const{current:e}=i,t=e=>{const{target:t}=e;if(!(t instanceof HTMLDivElement))return;const{scrollTop:n}=t;s(n>0)};return e.addEventListener("scroll",t),()=>{e.removeEventListener("scroll",t)}}),[]),r.createElement(me,null,r.createElement(bs,{onToggle:()=>t(!e),scrolled:n}),r.createElement("main",{className:Ts},r.createElement($s,{display:e,setDisplay:t,sections:Os}),r.createElement("div",{ref:i,className:Rs},r.createElement("article",null,r.createElement(pe,null,r.createElement(fe,{exact:!0,path:"/"},r.createElement(Ee,null)),r.createElement(fe,{exact:!0,path:"/online-demo"},r.createElement(ds,{content:"# Milkdown\n\n![logo](https://preview.redd.it/us7w1x2zx8461.jpg?auto=webp&s=077a73d5c08aec0bc0fb48c5e5be40c928467bb6)\n\n> Milkdown is a WYSIWYG markdown editor.\n>\n> Here is the [repo](https://github.com/Saul-Mirone/milkdown) (_right click to open link_).\n\nYou can check the output markdown text in **developer tool**.\n\n---\n\nYou can add `inline code` and code block:\n\n```javascript\nfunction main() {\n    console.log('Hello milkdown!');\n}\n```\n\n---\n\nYou can type `||` and a `space` to create a table:\n\n| First Header   |   Second Header    |\n| -------------- | :----------------: |\n| Content Cell 1 |  `Content` Cell 1  |\n| Content Cell 2 | **Content** Cell 2 |\n\n---\n\nMath is supported by [TeX expression](https://en.wikipedia.org/wiki/TeX).\n\nNow we have some inline math: $V \\times W \\stackrel{\\otimes}{\\rightarrow} V \\otimes W$. You can click to edit it.\n\nMath block is also supported.\n\n$$\n\\begin{aligned}\nT( (v_1 + v_2) \\otimes w) &= T(v_1 \\otimes w) + T(v_2 \\otimes w) \\\\\nT( v \\otimes (w_1 + w_2)) &= T(v \\otimes w_1) + T(v \\otimes w_2) \\\\\nT( (\\alpha v) \\otimes w ) &= T( \\alpha ( v \\otimes w) ) \\\\\nT( v \\otimes (\\alpha w) ) &= T( \\alpha ( v \\otimes w) ) \\\\\n\\end{aligned}\n$$\n\nYou can type `$$` and a `space` to create a math block.\n\n---\n\nHave fun!\n"})),Ns.map(((e,t)=>r.createElement(fe,{key:t.toString(),path:e.link},r.createElement(ds,{content:e.content,readOnly:!0})))))),r.createElement(Ps,null))))};const Ds=document.getElementById("app");ge.render(r.createElement(Ws,null),Ds);

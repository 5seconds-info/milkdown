var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,s=Object.getOwnPropertySymbols,r=Object.prototype.propertyIsEnumerable,n=(t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,i=(e,i)=>{for(var a in i||(i={}))t.call(i,a)&&n(e,a,i[a]);if(s)for(var a of s(i))r.call(i,a)&&n(e,a,i[a]);return e};import{M as a,I as o,t as l,w as c,a as h,s as u,b as d,l as p,E as m,D as g,S as k,k as f,c as w,h as b,i as M,u as v,r as y,d as x,e as E,f as O,g as N,P as D,j as _}from"./vendor.aed8e15d.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(s){const r=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((s,i)=>{const a=new URL(e,r);if(self[t].moduleMap[a])return s(self[t].moduleMap[a]);const o=new Blob([`import * as m from '${a}';`,`${t}.moduleMap['${a}']=m;`],{type:"text/javascript"}),l=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){i(new Error(`Failed to import: ${e}`)),n(l)},onload(){s(self[t].moduleMap[a]),n(l)}});document.head.appendChild(l)})),self[t].moduleMap={}}}("/milkdown/assets/");class S{constructor(e){this.plugins=e}loadNodes(e,t){return[e,...this.plugins.filter((e=>e.getNodes)).map((e=>e.getNodes))].reduce(((e,t)=>t(e)),t)}loadMarks(e,t){return[e,...this.plugins.filter((e=>e.getMarks)).map((e=>e.getMarks))].reduce(((e,t)=>t(e)),t)}loadMarkdownPlugin(e){const t=this.plugins.filter((e=>e.markdownIt)).map((e=>e.markdownIt));t.filter((e=>e.enable)).forEach((t=>{e.enable(t.enable)})),t.filter((e=>e.plugins)).forEach((t=>{t.plugins.forEach((t=>{Array.isArray(t)?t.length>0&&e.use(...t):e.use(t)}))}))}loadProsemirrorPlugin(e,t){return this.plugins.filter((e=>e.prosemirror)).map((e=>e.prosemirror)).map((s=>s(e,t))).flatMap((e=>e.plugins))}}class ${constructor(e,t,s){this.stack=e,this.schema=t,this.tokenHandlers=s}parseTokens(e){e.forEach(((t,s)=>{const r=this.tokenHandlers[t.type];if(!r)throw new Error("Token type `"+t.type+"` not supported by Markdown parser");r(this,t,e,s)}))}addText(e){e&&this.stack.addText((t=>this.schema.text(e,t)))}transformTokensToDoc(e){this.parseTokens(e);let t=null;do{t=this.stack.closeNode()}while(this.stack.length);return t}}function C(e){return e.isText}class R{constructor(e){this.els=[{type:e,content:[]}],this.marks=a.none}top(){const{els:e}=this;return e[e.length-1]}pushInTopEl(e){var t;null==(t=this.top())||t.content.push(e)}get length(){return this.els.length}openMark(e){this.marks=e.addToSet(this.marks)}closeMark(e){this.marks=e.removeFromSet(this.marks)}addText(e){const t=this.top();if(!t)throw new Error;const s=t.content,r=s[s.length-1],n=e(this.marks),i=r&&function(e,t){if(C(e)&&C(t)&&a.sameSet(e.marks,t.marks))return e.withText(e.text+t.text)}(r,n);i?s[s.length-1]=i:s.push(n)}openNode(e,t){this.els.push({type:e,attrs:t,content:[]})}addNode(e,t,s){const r=e.createAndFill(t,s,this.marks);return r?(this.pushInTopEl(r),r):null}closeNode(){this.marks.length&&(this.marks=a.none);const e=this.els.pop();if(!e)throw new Error;return this.addNode(e.type,e.attrs,e.content)}}function z(e,t,s,r){return e.getAttrs?e.getAttrs(t,s,r):e.attrs}function A(){}function B(e,t){const s={softbreak:e=>e.addText("\n")};return Object.entries(t).forEach((([t,r])=>{if(function(e){return Reflect.has(e,"block")}(r)){const n=e.nodes[r.block];if(!n)throw new Error;return["hr","hardbreak","fence"].includes(t)?void(s[t]=(e,t,s,i)=>{e.stack.openNode(n,z(r,t,s,i)),e.addText(t.content),e.stack.closeNode()}):(s[t+"_open"]=(e,t,s,i)=>e.stack.openNode(n,z(r,t,s,i)),void(s[t+"_close"]=e=>e.stack.closeNode()))}if(!function(e){return Reflect.has(e,"node")}(r)){if(function(e){return Reflect.has(e,"mark")}(r)){const n=e.marks[r.mark];if(!n)throw new Error;return["code_inline"].includes(t)?void(s[t]=(e,t,s,i)=>{e.stack.openMark(n.create(z(r,t,s,i))),e.addText(t.content),e.stack.closeMark(n)}):(s[t+"_open"]=(e,t,s,i)=>e.stack.openMark(n.create(z(r,t,s,i))),void(s[t+"_close"]=e=>e.stack.closeMark(n)))}if(function(e){return Reflect.has(e,"ignore")}(r))return s[t+"_open"]=A,void(s[t+"_close"]=A);throw new RangeError("Unrecognized parsing spec "+JSON.stringify(r))}{const n=e.nodes[r.node];if(!n)throw new Error;s[t]=(e,t,s,i)=>e.stack.addNode(n,z(r,t,s,i))}})),s.inline=(e,t)=>{var s;return e.parseTokens(null!=(s=t.children)?s:[])},s.text=(e,t)=>e.addText(t.content),s}class I{static escape(e,t){let s=e.replace(/[`*\\~[\]]/g,"\\$&");return t&&(s=s.replace(/^[:#\-*+]/,"\\$&").replace(/^(\d+)\./,"$1\\.")),s}static quote(e){const t=-1===e.indexOf('"')?'""':-1===e.indexOf("'")?"''":"()";return t[0]+e+t[1]}static repeat(e,t){return Array(t).fill(e).reduce(((e,t)=>e+t),"")}static getEnclosingWhitespace(e){return{leading:(e.match(/^(\s+)/)||[])[0],trailing:(e.match(/(\s+)$/)||[])[0]}}static removeWhiteSpaceAfter(e){const t=/\s+$/.exec(e);return t?e.slice(0,t.index):e}}class T{constructor(e,t){this.nodes=e,this.marks=t,this.out="",this.delimitation="",this.closed=!1,this.utils=I,this.nodes=e,this.marks=t}get output(){return this.out}get atBlank(){return/(^|\n)$/.test(this.out)}renderContent(e){return e.forEach(((t,s,r)=>this.render(t,e,r))),this}render(e,t,s){const r=this.nodes[e.type.name];if(!r)throw new Error;return r(this,e,t,s),this}ensureNewLine(){return this.atBlank||(this.out+="\n"),this}closeBlock(e){return this.closed=e,this}flushClose(e=1){if(!this.closed)return this;if(this.atBlank||(this.out+="\n"),e>=1){const t=this.utils.removeWhiteSpaceAfter(this.delimitation),s=this.utils.repeat(t+"\n",e);this.out+=s}return this.closed=!1,this}write(e){return this.flushClose(),e?(this.delimitation&&this.atBlank&&(this.out+=this.delimitation),this.out+=e,this):this}text(e,t=!1){const s=e.split("\n");return s.forEach(((e,r)=>{const n=t?this.utils.escape(e,Boolean(this.atBlank||this.closed)):e;this.write(n);r===s.length-1||(this.out+="\n")})),this}wrapBlock(e,t,s,r=e){this.write(r);const n=this.delimitation;return this.delimitation+=e,s(),this.delimitation=n,this.closeBlock(t),this}markString(e,t,s,r){const n=this.marks[e.type.name];if(!n)throw new Error;const i=t?n.open:n.close;return"string"==typeof i?i:i(this,e,s,r)}wrapWithMark(e,t,s,r){const n=this.markString(e,!0,t,s),i=this.markString(e,!1,t,s+1);return this.text(n+r+i),this}serializeMarks(e,t,s,r=!1){return e.map((e=>this.markString(e,r,t,s))).join("")}renderInline(e){let t=[];const s=(e=!1)=>(t,s)=>{var r,n,i,a;const o=null!=(n=null==(r=this.marks[t.type.name])?void 0:r.priority)?n:0,l=null!=(a=null==(i=this.marks[s.type.name])?void 0:i.priority)?a:0;return e?o-l:l-o};return e.forEach(((r,n,i)=>{if(!C(r))return void this.render(r,e,i);const a=r.marks||[],o=t.filter((e=>!a.includes(e))).sort(s()),l=a.filter((e=>!t.includes(e))).sort(s(!0));l.forEach((e=>t.push(e))),t=t.filter((e=>!o.includes(e)));const c=this.serializeMarks(l,e,i,!0),h=this.serializeMarks(o,e,i+1);this.write(h+c+r.text)})),(()=>{const s=this.serializeMarks(t,e,e.childCount+1);this.write(s)})(),this}renderList(e,t,s){this.closed&&this.closed.type===e.type&&this.flushClose(2),e.forEach(((r,n,i)=>{this.wrapBlock(t,e,(()=>this.render(r,e,i)),s(i))}))}}class L{constructor(e){this.editor=e}}class j extends L{}class P extends L{}function V(e,t){return new o(e,((e,s,r,n)=>{const{tr:i}=e,a=s.length;let o=r,l=n;if(s[a-1]){const c=s[0],h=s[a-1],u=s[a-2],d=r+c.indexOf(u),p=d+u.length-1,m=d+u.lastIndexOf(h),g=m+h.length;if(function(e,t,s){let r=[];return s.doc.nodesBetween(e,t,((e,t)=>{r=[...r,...e.marks.map((s=>({start:t,end:t+e.nodeSize,mark:s})))]})),r}(r,n,e).filter((e=>e.mark.type.excludes(t))).filter((e=>e.end>d)).length)return null;g<p&&i.delete(g,p),m>d&&i.delete(d,m),o=d,l=o+h.length}return i.addMark(o,l,t.create()),i.removeStoredMark(t),i}))}const W=[class extends j{constructor(){super(...arguments),this.name="link",this.schema={attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>({href:e.getAttribute("href"),title:e.getAttribute("title")})}],toDOM:e=>["a",i(i({},e.attrs),{class:"link"})]},this.parser={mark:"link",getAttrs:e=>({href:e.attrGet("href"),title:e.attrGet("title")||null})},this.serializer={open:()=>"[",close:(e,t)=>`](${e.utils.escape(t.attrs.href)}${t.attrs.title?` ${e.utils.quote(t.attrs.title)}`:""})`,priority:1},this.inputRules=(e,t)=>[new o(/\[(?<text>.+?)]\((?<href>.*?)(?=â€œ|\))"?(?<title>[^"]+)?"?\)/,((s,r,n,i)=>{const[a,o="",l,c]=r,{tr:h}=s;return a&&h.replaceWith(n,i,t.text(o)).addMark(n,o.length+n,e.create({title:c,href:l})),h}))]}},class extends j{constructor(){super(...arguments),this.name="strong",this.schema={parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-style",getAttrs:e=>"bold"===e}],toDOM:()=>["strong",{class:"strong"}]},this.parser={mark:this.name},this.serializer={open:"**",close:"**"},this.inputRules=e=>[V(/(?:__)([^_]+)(?:__)$/,e),V(/(?:\*\*)([^*]+)(?:\*\*)$/,e)],this.keymap=e=>({"Mod-b":l(e)})}},class extends j{constructor(){super(...arguments),this.name="code_inline",this.schema={excludes:"_",parseDOM:[{tag:"code"}],toDOM:()=>["code",{class:"code-inline"}]},this.parser={mark:"code_inline"},this.serializer={open:"`",close:"`"},this.inputRules=e=>[V(/(?:^|[^`])(`([^`]+)`)$/,e)]}},class extends j{constructor(){super(...arguments),this.name="em",this.schema={parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>"italic"===e}],toDOM:()=>["em",{class:"em"}]},this.parser={mark:"em"},this.serializer={open:"*",close:"*"},this.inputRules=e=>[V(/(?:^|[^_])(_([^_]+)_)$/,e),V(/(?:^|[^*])(\*([^*]+)\*)$/,e)],this.keymap=e=>({"Mod-i":l(e)})}}];const q=Array(5).fill(0).map(((e,t)=>t+1));const U=["","javascript","typescript","bash","sql","json","c","cpp","java","ruby","python","go","rust"];const G=[class extends P{constructor(){super(...arguments),this.name="paragraph",this.schema={content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:()=>["p",{class:"paragraph"},0]},this.parser={block:this.name},this.serializer=(e,t)=>{e.renderInline(t).closeBlock(t)}}},class extends P{constructor(){super(...arguments),this.name="hardbreak",this.schema={inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br",{class:"bard-break"}]},this.parser={block:this.name},this.serializer=e=>{e.write("  \n")},this.keymap=e=>({"Shift-Enter":(t,s)=>(null==s||s(t.tr.replaceSelectionWith(e.create()).scrollIntoView()),!0)})}},class extends P{constructor(){super(...arguments),this.name="blockquote",this.schema={content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",{class:"blockquote"},0]},this.parser={block:this.name},this.serializer=(e,t)=>{e.wrapBlock("> ",t,(()=>e.renderContent(t)))},this.inputRules=e=>[c(/^\s*>\s$/,e)]}},class extends P{constructor(){super(...arguments),this.name="fence",this.schema={content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>({language:e.dataset.language})}],toDOM:e=>{const t=this.createSelectElement(e.attrs.language);return["div",{"data-language":e.attrs.language,class:"code-fence"},["div",{contentEditable:"false"},t],["pre",["code",{spellCheck:"false"},0]]]}},this.parser={block:this.name,getAttrs:e=>({language:e.info})},this.serializer=(e,t)=>{e.write("```"+t.attrs.language+"\n"),e.text(t.textContent),e.ensureNewLine(),e.write("```"),e.closeBlock(t)},this.inputRules=e=>[h(/^```$/,e)],this.keymap=()=>({Tab:(e,t)=>{const{tr:s,selection:r}=e;return!!t&&(t(s.insertText("  ",r.from,r.to)),!0)}})}onChangeLanguage(e,t,s){const{view:r}=this.editor,n=r.posAtCoords({top:e,left:t});if(!n)return;const i=r.state.tr.setNodeMarkup(n.inside,void 0,{language:s});r.dispatch(i)}createSelectElement(e){const t=document.createElement("select");return t.className="code-fence_select",t.addEventListener("change",(e=>{if(this.editor.loadState!==K.Complete)throw new Error("Should not trigger event before milkdown ready.");const t=e.target;if(!t)return;const{top:s,left:r}=t.getBoundingClientRect();this.onChangeLanguage(s,r,t.value)})),U.forEach((s=>{const r=document.createElement("option");r.className="code-fence_select-option",r.value=s,r.innerText=s||"--",r.selected=e===s,t.appendChild(r)})),t}},class extends P{constructor(){super(...arguments),this.name="ordered_list",this.schema={content:"list_item+",group:"block",attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:e=>({order:e.hasAttribute("start")?Number(e.getAttribute("start")):1})}],toDOM:e=>["ol",i(i({},1===e.attrs.order?{}:e.attrs.order),{class:"ordered-list"}),0]},this.parser={block:this.name},this.serializer=(e,t)=>{const{order:s=1}=t.attrs,r=(""+(s+t.childCount-1)).length,n=e.utils.repeat(" ",r+2);e.renderList(t,n,(t=>{const n=`${s+t}`;return e.utils.repeat(" ",r-n.length)+n+". "}))},this.inputRules=e=>[c(/^(\d+)\.\s$/,e,(e=>({order:Number(e[1])})),((e,t)=>t.childCount+t.attrs.order===Number(e[1])))]}},class extends P{constructor(){super(...arguments),this.name="bullet_list",this.schema={content:"list_item+",group:"block",parseDOM:[{tag:"ul"}],toDOM:()=>["ul",{class:"bullet-list"},0]},this.parser={block:this.name},this.serializer=(e,t)=>{e.renderList(t,"  ",(()=>"* "))},this.inputRules=e=>[c(/^\s*([-+*])\s$/,e)]}},class extends P{constructor(){super(...arguments),this.name="list_item",this.schema={content:"paragraph block*",defining:!0,parseDOM:[{tag:"li"}],toDOM:()=>["li",{class:"list-item"},0]},this.parser={block:this.name},this.serializer=(e,t)=>{e.renderContent(t)},this.keymap=e=>({Enter:u(e),"Mod-]":d(e),"Mod-[":p(e)})}},class extends P{constructor(){super(...arguments),this.name="heading",this.schema={content:"text*",group:"block",attrs:{level:{default:1}},parseDOM:q.map((e=>({tag:`h${e}`,attrs:{level:e}}))),toDOM:e=>[`h${e.attrs.level}`,{class:`heading h${e.attrs.level}`},0]},this.parser={block:this.name,getAttrs:e=>({level:Number(e.tag.slice(1))})},this.serializer=(e,t)=>{e.write(`${e.utils.repeat("#",t.attrs.level)} `),e.renderInline(t),e.closeBlock(t)},this.inputRules=e=>q.map((t=>h(new RegExp(`^(#{1,${t}})\\s$`),e,(()=>({level:t})))))}},class extends P{constructor(){super(...arguments),this.name="hr",this.schema={group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["hr",{class:"hr"}]},this.parser={block:this.name},this.serializer=(e,t)=>{e.write("---"),e.closeBlock(t)},this.inputRules=e=>[new o(/^(?:---|___\s|\*\*\*\s)$/,((t,s,r,n)=>{const{tr:i}=t;return s[0]&&i.replaceWith(r,n,e.create({})),i}))]}},class extends P{constructor(){super(...arguments),this.name="image",this.schema={inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:e=>({src:e.getAttribute("src"),alt:e.getAttribute("alt"),title:e.getAttribute("title")})}],toDOM:e=>["img",i(i({},e.attrs),{class:"image"})]},this.parser={node:"image",getAttrs:e=>{var t,s;return{src:e.attrGet("src"),alt:(null==(s=null==(t=e.children)?void 0:t[0])?void 0:s.content)||null,title:e.attrGet("title")}}},this.serializer=(e,t)=>{const s=e.utils.escape(t.attrs.alt||""),r=t.attrs.title?" "+e.utils.quote(t.attrs.title):"",n=e.utils.escape(t.attrs.src)+r;e.write(`![${s}](${n}) `)},this.inputRules=e=>[new o(/!\[(?<alt>.*?)]\((?<filename>.*?)(?=â€œ|\))"?(?<title>[^"]+)?"?\)/,((t,s,r,n)=>{const[i,a,o,l]=s,{tr:c}=t;return i&&c.replaceWith(r,n,e.create({src:o,alt:a,title:l})),c}))]}},class extends P{constructor(){super(...arguments),this.name="tab_indent",this.schema={group:"inline",inline:!0,selectable:!1,parseDOM:[{tag:"span[class='tab-indent']"}],toDOM:()=>["span",{class:"tab-indent"},"  "]},this.parser={block:this.name},this.serializer=e=>{e.write("  ")},this.keymap=e=>({Tab:(t,s)=>{const{selection:r}=t.tr,n=Boolean(t.tr);if(!r)return n;const{from:i,to:a}=r;if(i!==a||!e)return n;const o=t.tr.replaceSelectionWith(e.create()).scrollIntoView();return null==s||s(o),Boolean(o)}})}}];function F(e,t,s={}){return e.reduce(((e,s)=>{const[r,n]=t(s);return i(i({},e),{[r]:n})}),s)}class H{constructor(e,t,s,r){this.onChange=r;const n=this.createViewContainer(e),i=new m(n,{state:t,nodeViews:s,dispatchTransaction:e=>{const t=this.view.state.apply(e);i.updateState(t),this.onChange(this.view)}});this.prepareViewDom(i.dom),this.view=i}createViewContainer(e){const t=document.createElement("div");return t.className="milkdown",e.appendChild(t),t}prepareViewDom(e){e.classList.add("editor"),e.setAttribute("role","textbox")}}var K,Y;(Y=K||(K={}))[Y.Idle=0]="Idle",Y[Y.Complete=1]="Complete";const J=(Q=e=>e.isBlock,(e,t)=>((e,t=!0)=>{const s=[];return e.descendants(((e,r)=>{if(s.push({node:e,pos:r}),!t)return!1})),s})(e,t).filter((e=>Q(e.node))));var Q;const X={};const Z="MILKDOWN_PLUGIN_PRISM";function ee(e){let t=!1;return new D({key:new _(Z),state:{init:(e,{doc:t})=>E.create(t,[]),apply:(s,r,n,i)=>{const a=i.selection.$head.parent.type.name===e,o=n.selection.$head.parent.type.name===e,l=s.docChanged&&(a||o);return!t||l?(t=!0,function(e,t){const s=[],r=J(e).filter((e=>e.node.type.name===t));return r.forEach((e=>{var t;let r=e.pos+1;const n=e.node.attrs.language;if(n){if(!(null==(t=X[e.pos])?void 0:t.node.eq(e.node))){const t=O.highlight(e.node.textContent,n),s=(e,t=[])=>e.flatMap((e=>"element"===e.type?s(e.children,[...t,...e.properties.className||[]]):[{text:e.value,className:t}])),i=s(t).map((({text:e,className:t})=>{const s=r,n=s+e.length;return r=n,N.inline(s,n,{class:t.join(" ")})}));X[e.pos]={node:e.node,dec:i}}X[e.pos].dec.forEach((e=>{s.push(e)}))}})),Object.keys(X).filter((e=>!r.find((t=>t.pos===Number(e))))).forEach((e=>{delete X[Number(e)]})),E.create(e,s)}(s.doc,e)):r.map(s.mapping,s.doc)}},view:e=>(window.requestAnimationFrame((()=>{e.dispatch(e.state.tr.setMeta(Z,{loaded:!0}))})),{}),props:{decorations(e){return this.getState(e)}}})}const te={prosemirror:e=>{if(!e.nodes.fence)throw new Error("[Milkdown Prism Plugin]: load failed, No code fence in schema!");return{plugins:[ee(e.nodes.fence.name)]}}};const se=document.getElementById("app");if(!se)throw new Error;new class{constructor({root:e,onChange:t,defaultValue:s="",markdownIt:r=new g("commonmark"),getNodes:n=(e=>e),getMarks:i=(e=>e),plugins:a=[]}){this.createInstance=e=>new e(this),this.loadState=K.Idle,this.onChange=t,this.root=e,this.pluginLoader=new S(a),this.nodes=this.pluginLoader.loadNodes(n,G).map(this.createInstance),this.marks=this.pluginLoader.loadMarks(i,W).map(this.createInstance),this.markdownIt=r,this.pluginLoader.loadMarkdownPlugin(r),this.schema=this.createSchema(),this.parser=this.createParser(),this.serializer=this.createSerializer(),this.inputRules=this.createInputRules(),this.keymap=this.createKeymap(),this.nodeViews=this.createNodeViews(),this.view=this.createView(e,s),this.loadState=K.Complete}get value(){return this.serializer(this.view.state.doc)}createSchema(){const e=F(this.nodes,(e=>[e.name,e.schema])),t=F(this.marks,(e=>[e.name,e.schema]));return new k({nodes:i(i({doc:{content:"block+"}},e),{text:{group:"inline"}}),marks:t})}createParser(){const e=F([...this.nodes,...this.marks],(e=>[e.name,e.parser]));return t=this.schema,s=this.markdownIt,r=e,e=>new $(new R(t.topNodeType),t,B(t,r)).transformTokensToDoc(s.parse(e,{}));var t,s,r}createSerializer(){return function(e,t){return s=>{const r=new T(e,t);return r.renderContent(s),r.output}}(F(this.nodes,(e=>[e.name,e.serializer]),{text(e,t){const{text:s}=t;s&&e.text(s)}}),F(this.marks,(e=>[e.name,e.serializer])))}createInputRules(){return[...this.nodes.filter((e=>Boolean(e.inputRules))).reduce(((e,t)=>{const s=this.schema.nodes[t.name];return s?[...e,...t.inputRules(s,this.schema)]:e}),[]),...this.marks.filter((e=>Boolean(e.inputRules))).reduce(((e,t)=>{const s=this.schema.marks[t.name];return s?[...e,...t.inputRules(s,this.schema)]:e}),[])]}createKeymap(){return[...this.nodes.filter((e=>Boolean(e.keymap))).map((e=>{const t=this.schema.nodes[e.name];if(!t)throw new Error;return e.keymap(t)})),...this.marks.filter((e=>Boolean(e.keymap))).map((e=>{const t=this.schema.marks[e.name];if(!t)throw new Error;return e.keymap(t)}))].map((e=>f(e)))}createNodeViews(){const e=this.nodes.filter((e=>Boolean(e.view))).reduce(((e,t)=>{const s=this.schema.nodes[t.name];if(!s)throw new Error;return i(i({},e),{[t.name]:(...e)=>t.view(this,s,...e)})}),{}),t=this.marks.filter((e=>Boolean(e.view))).reduce(((e,t)=>{const s=this.schema.marks[t.name];if(!s)throw new Error;return i(i({},e),{[t.name]:(...e)=>t.view(this,s,...e)})}),{});return i(i({},e),t)}createView(e,t){const s=this.createEditorState(t),{view:r}=new H(e,s,this.nodeViews,(e=>{var t;null==(t=this.onChange)||t.call(this,(()=>this.serializer(e.state.doc)))}));return r}createEditorState(e){const t=this.parser(e);return w.create({schema:this.schema,doc:t,plugins:[b(),M({rules:this.inputRules}),...this.keymap,f({"Mod-z":v,"Shift-Mod-z":y}),f(x),...this.pluginLoader.loadProsemirrorPlugin(this.schema,this.view)]})}}({root:se,defaultValue:"\n# Milkdown\n\n![logo](/milkdown/milkdown-mini.svg)\n\n> Milkdown is a WYSIWYG markdown editor.\n>\n> Here is the [repo](https://github.com/Saul-Mirone/milkdown) (*right click to open link*).\n\nYou can check the output markdown text in **developer tool**.\n",onChange:e=>console.log(e()),plugins:[te]});
